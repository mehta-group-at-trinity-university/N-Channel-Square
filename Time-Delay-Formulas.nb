(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    199427,       6284]
NotebookOptionsPosition[    188009,       5953]
NotebookOutlinePosition[    188458,       5972]
CellTagsIndexPosition[    188415,       5969]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Time-Delay expression for N-Channel", "Title",
 CellChangeTimes->{{3.738583495960883*^9, 3.738583513300105*^9}}],

Cell["NPM", "Author",
 CellChangeTimes->{{3.73858453598549*^9, 3.738584536788189*^9}}],

Cell[CellGroupData[{

Cell["Finding a better way to calculate the time delay", "Section",
 CellChangeTimes->{{3.738539242724346*^9, 3.738539250098666*^9}}],

Cell[TextData[{
 "The time delay is currently calculated as a numerical derivative of the \
phase shift ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", "=", 
    RowBox[{
     RowBox[{"2", "\[HBar]", " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "\[Delta]"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "\[TildeTilde]", 
     RowBox[{"2", "\[HBar]", " ", 
      FractionBox["\[CapitalDelta]\[Delta]", "\[CapitalDelta]E"]}]}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", which is numerically unstable in some cases"
}], "Text",
 CellChangeTimes->{{3.738539251082361*^9, 3.7385393254566708`*^9}}],

Cell["We have a matrix equation of the form:", "Text",
 CellChangeTimes->{{3.7385845390730352`*^9, 3.738584546411788*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", "x"}], " ", "=", " ", "b"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738584548325417*^9, 3.738584555259263*^9}}],

Cell["Taking an energy derivative of both sides", "Text",
 CellChangeTimes->{{3.738584557878879*^9, 3.738584566852236*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"A", " ", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]], "x"}]}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738584571068177*^9, 3.738584591113628*^9}}],

Cell[TextData[{
 "But if the first equation is solved, then ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is known, so we now have an equation for the energy derivative of ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]], "x"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  To find ",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", we need ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[DifferentialD]", "A"}], 
    RowBox[{"\[DifferentialD]", "E"}]], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.738584593637319*^9, 3.738584670793653*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", "x"}], " ", "=", " ", 
   RowBox[{"b", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "11"],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{"1", "N"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           RowBox[{"-", 
            SubscriptBox["g", "1"]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "11"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{"1", "N"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["g", "1"]}], 
             RowBox[{"\[PartialD]", "r"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
         {
          StyleBox["\[VerticalEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[DescendingEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[VerticalEllipsis]",
           FontColor->RGBColor[1, 0, 0]], "0", "\[DescendingEllipsis]", "0", 
          "0", "0"},
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{
             RowBox[{"N", "-", "1"}], ",", "1"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{
             RowBox[{"N", "-", "1"}], ",", "N"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", 
          StyleBox[
           RowBox[{"-", 
            SubscriptBox["g", 
             RowBox[{"N", "-", "1"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0"},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{
               RowBox[{"N", "-", "1"}], ",", "1"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{
               RowBox[{"N", "-", "1"}], ",", "N"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", 
          StyleBox[
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["g", 
               RowBox[{"N", "-", "1"}]]}], 
             RowBox[{"\[PartialD]", "r"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0"},
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "N1"],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "NN"],
           FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
          RowBox[{"-", 
           SubscriptBox["f", "o"]}], 
          SubscriptBox["g", "o"]},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "N1"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "NN"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["f", "o"]}], 
            RowBox[{"\[PartialD]", "r"}]]}], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["g", "o"]}], 
           RowBox[{"\[PartialD]", "r"}]]},
         {"0", "0", "0", "0", "0", "0", "1", "0"}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["b", "1"]},
         {"\[VerticalEllipsis]"},
         {
          SubscriptBox["b", "N"]},
         {
          SubscriptBox["a", "1"]},
         {"\[VerticalEllipsis]"},
         {
          SubscriptBox["a", 
           RowBox[{"N", "-", "1"}]]},
         {"c"},
         {"s"}
        }], ")"}]}], "=", 
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"\[VerticalEllipsis]"},
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"1"}
       }], ")"}]}]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385846477758102`*^9, 3.738584678625204*^9}, 
   3.738584712835949*^9, {3.738847193425844*^9, 3.738847199266094*^9}}],

Cell["Let\[CloseCurlyQuote]s take this piece by piece.", "Text",
 CellChangeTimes->{{3.738584754455583*^9, 3.7385847739599733`*^9}}],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", "?"}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.738584754455583*^9, 3.738584795827755*^9}}],

Cell["We know", "Text",
 CellChangeTimes->{{3.738584809655547*^9, 3.7385848110647306`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalPhi]", "i\[Alpha]"], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], 
    RowBox[{"{", GridBox[{
       {
        RowBox[{
         SubscriptBox["f", "L"], 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]},
       {
        RowBox[{
         SubscriptBox["f", 
          RowBox[{"b", " ", "L"}]], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}
      }]}]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738584813346284*^9, 3.7385848616879873`*^9}, {
  3.7385852243571053`*^9, 3.738585255060252*^9}}],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "L"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is the Riccati-Bessel function and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "\[Alpha]"], "=", 
    SqrtBox[
     RowBox[{
      RowBox[{"2", "\[Mu]", " ", "E"}], "-", 
      SuperscriptBox[
       SubscriptBox["\[Lambda]", "\[Alpha]"], "2"]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " "
}], "Text",
 CellChangeTimes->{{3.738584849540257*^9, 3.738584894739476*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["f", "L"], "(", 
        RowBox[{
         SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["f", "L"], "(", 
         RowBox[{
          SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], "r", " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["k", "\[Alpha]"]}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["U", "i\[Alpha]"], 
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         RowBox[{
          SubscriptBox["f", "L"], "(", 
          RowBox[{
           SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], "r", " ", 
       FractionBox["1", 
        RowBox[{"2", 
         SubscriptBox["k", "\[Alpha]"]}]], "2", "\[Mu]"}], "=", 
      RowBox[{
       SubscriptBox["U", "i\[Alpha]"], 
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         RowBox[{
          SubscriptBox["f", "L"], "(", 
          RowBox[{
           SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], " ", 
       FractionBox[
        RowBox[{"\[Mu]", " ", "r"}], 
        SubscriptBox["k", "\[Alpha]"]]}]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385849357691727`*^9, 3.7385850327331467`*^9}, {
  3.7385851632082043`*^9, 3.738585186366899*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SubscriptBox["f", "L"], "(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], " ", 
    FractionBox[
     RowBox[{"\[Mu]", " ", "r"}], 
     SubscriptBox["k", "\[Alpha]"]]}]}], TraditionalForm]], "EquationNumbered",\

 CellChangeTimes->{{3.738585199053013*^9, 3.738585202590466*^9}}],

Cell[TextData[{
 "Similarly, for the modified type with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Kappa]", "\[Alpha]"], "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Lambda]", "\[Alpha]"], "2"], "-", 
      RowBox[{"2", "\[Mu]", " ", "E"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.738585206147378*^9, 3.7385852187971983`*^9}, {
  3.7385852829865007`*^9, 3.7385853002154627`*^9}, {3.7385853873087797`*^9, 
  3.738585392329632*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["f", 
         RowBox[{"b", " ", "L"}]], "(", 
        RowBox[{
         SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["f", "L"], "(", 
         RowBox[{
          SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], "r", " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["f", "L"], "(", 
         RowBox[{
          SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], "r", " ", 
      FractionBox["1", 
       RowBox[{"2", 
        SubscriptBox["\[Kappa]", "\[Alpha]"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "\[Mu]"}], ")"}]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.738585215431856*^9, {3.7385852776510553`*^9, 3.738585281394487*^9}, {
   3.73858540392509*^9, 3.738585475964533*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["U", "i\[Alpha]"]}], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SubscriptBox["f", "L"], "(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], " ", 
    FractionBox[
     RowBox[{"\[Mu]", " ", "r"}], 
     SubscriptBox["\[Kappa]", "\[Alpha]"]]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738585484524446*^9, 3.738585510473003*^9}}],

Cell["Now the tougher one is the double derivative:", "Text",
 CellChangeTimes->{{3.738585532847089*^9, 3.738585542001161*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", "?"}], 
  TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.7385855459685793`*^9, 3.738585561796967*^9}}],

Cell["We already need to calculate:", "Text",
 CellChangeTimes->{{3.7385855760756607`*^9, 3.738585585999074*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
    RowBox[{"\[DifferentialD]", "r"}]], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], " ", "\[Times]", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            FractionBox[
             RowBox[{"\[DifferentialD]", 
              RowBox[{
               SubscriptBox["f", "L"], "(", 
               RowBox[{
                SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
             RowBox[{"\[DifferentialD]", "r"}]], 
            RowBox[{"E", ">", 
             SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
           {
            FractionBox[
             RowBox[{"\[DifferentialD]", 
              RowBox[{
               SubscriptBox["f", 
                RowBox[{"b", " ", "L"}]], "(", 
               RowBox[{
                SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
             RowBox[{"\[DifferentialD]", "r"}]], 
            RowBox[{"E", "<", 
             SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "   ", "=", 
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], "\[Times]", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", "L"], "(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], 
             SubscriptBox["k", "\[Alpha]"]}], 
            RowBox[{"E", ">", 
             SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
           {
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", 
                 RowBox[{"b", " ", "L"}]], "(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], 
             SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
            RowBox[{"E", "<", 
             SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], "   "}]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385850565138607`*^9, 3.738585124906288*^9}, 
   3.7385851576656237`*^9, {3.738585572917471*^9, 3.738585822788454*^9}}],

Cell[TextData[{
 "But now we need an additional derivative with respect to the energy. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["U", "i\[Alpha]"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is thankfully independent of energy)"
}], "Text",
 CellChangeTimes->{{3.738585828003686*^9, 3.7385858810583277`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "r"}]]}], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], "\[Times]", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             FractionBox["\[DifferentialD]", 
              RowBox[{"\[DifferentialD]", "E"}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", "L"], "(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]]}], 
            SubscriptBox["k", "\[Alpha]"]}], 
           RowBox[{"E", ">", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox["\[DifferentialD]", 
              RowBox[{"\[DifferentialD]", "E"}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", 
                 RowBox[{"b", " ", "L"}]], "(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]]}], 
            SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
           RowBox[{"E", "<", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "   "}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385858478405724`*^9, 3.738585915513753*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "r"}]]}], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], "\[Times]", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", "L"], "(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["k", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             SubscriptBox["k", "\[Alpha]"], 
             RowBox[{
              FractionBox["\[DifferentialD]", 
               RowBox[{"\[DifferentialD]", "E"}]], 
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                RowBox[{
                 SubscriptBox["f", "L"], "(", 
                 RowBox[{
                  SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
               RowBox[{"\[DifferentialD]", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]]}]}]}], 
           RowBox[{"E", ">", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", 
                 RowBox[{"b", " ", "L"}]], "(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             SubscriptBox["\[Kappa]", "\[Alpha]"], 
             RowBox[{
              FractionBox["\[DifferentialD]", 
               RowBox[{"\[DifferentialD]", "E"}]], 
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                RowBox[{
                 SubscriptBox["f", 
                  RowBox[{"b", " ", "L"}]], "(", 
                 RowBox[{
                  SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
               RowBox[{"\[DifferentialD]", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]]}]}]}], 
           RowBox[{"E", "<", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "   "}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738585918045843*^9, 3.738585991800777*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "r"}]]}], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], "\[Times]", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", "L"], "(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["k", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             SubscriptBox["k", "\[Alpha]"], 
             RowBox[{
              FractionBox["\[DifferentialD]", 
               RowBox[{"\[DifferentialD]", "E"}]], 
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                RowBox[{
                 SubscriptBox["f", "L"], "(", 
                 RowBox[{
                  SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
               RowBox[{"\[DifferentialD]", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]]}]}]}], 
           RowBox[{"E", ">", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", 
                 RowBox[{"b", " ", "L"}]], "(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             SubscriptBox["\[Kappa]", "\[Alpha]"], 
             RowBox[{
              FractionBox["\[DifferentialD]", 
               RowBox[{"\[DifferentialD]", "E"}]], 
              FractionBox[
               RowBox[{"\[DifferentialD]", 
                RowBox[{
                 SubscriptBox["f", 
                  RowBox[{"b", " ", "L"}]], "(", 
                 RowBox[{
                  SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
               RowBox[{"\[DifferentialD]", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]]}]}]}], 
           RowBox[{"E", "<", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "   "}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.73858599698203*^9}],

Cell["\<\
The first term in each of these is straightforward, but we need now to \
calculate the second derivative of the Riccati-Bessel function\
\>", "Text",
 CellChangeTimes->{{3.738586056287672*^9, 3.738586092830884*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SubscriptBox["f", "L"], "(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]]}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], 
      RowBox[{
       SubscriptBox["f", "L"], "(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["k", "\[Alpha]"], "r"}], ")"}], "2"]}]], "r", " ", 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["k", "\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "E"}]]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738586098019844*^9, 3.7385861419715242`*^9}}],

Cell[TextData[{
 "But the Riccati-Bessel differential equation let\[CloseCurlyQuote]s us \
rewrite this in terms of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "L"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", since:"
}], "Text",
 CellChangeTimes->{{3.738586622381592*^9, 3.738586643446355*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["z", "2"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], 
      RowBox[{
       SubscriptBox["f", "L"], "(", "z", ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["z", "2"]}]]}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"L", "(", 
       RowBox[{"L", "+", "1"}], ")"}], "-", 
      SuperscriptBox["z", "2"]}], ")"}], 
    RowBox[{
     SubscriptBox["f", "L"], "(", "z", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385866470481052`*^9, 3.738586682767964*^9}, 
   3.738587281328865*^9, {3.73858796060765*^9, 3.738587971077186*^9}}],

Cell["Gives", "Text",
 CellChangeTimes->{{3.738587286478136*^9, 3.7385872871658707`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{
      SubscriptBox["f", "L"], "(", "z", ")"}]}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["z", "2"]}]], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"L", "(", 
        RowBox[{"L", "+", "1"}], ")"}], 
       SuperscriptBox["z", "2"]], "-", "1"}], ")"}], 
    SubscriptBox["f", "L"]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738587293250483*^9, 3.73858731084511*^9}}],

Cell["SO we have:", "Text",
 CellChangeTimes->{{3.738587329446869*^9, 3.738587330928463*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SubscriptBox["f", "L"], "(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]]}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"L", "(", 
        RowBox[{"L", "+", "1"}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["k", "\[Alpha]"], "r"}], ")"}], "2"]], "-", "1"}], 
     ")"}], 
    RowBox[{
     SubscriptBox["f", "L"], "(", 
     RowBox[{
      SubscriptBox["k", "\[Alpha]"], "r"}], ")"}], "r", " ", 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["k", "\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "E"}]]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738587336419403*^9, 3.738587369338097*^9}}],

Cell[TextData[{
 "The modified functions carry an extra minus sign with the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " term ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["k", "2"], "\[Rule]", 
     RowBox[{"-", 
      SuperscriptBox["\[Kappa]", "2"]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ")"
}], "Text",
 CellChangeTimes->{{3.738587774065874*^9, 3.73858780830249*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["z", "2"], 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], 
      RowBox[{
       SubscriptBox["f", "bL"], "(", "z", ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["z", "2"]}]]}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"L", "(", 
       RowBox[{"L", "+", "1"}], ")"}], "+", 
      SuperscriptBox["z", "2"]}], ")"}], 
    RowBox[{
     SubscriptBox["f", "bL"], "(", "z", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738587840125887*^9, 3.738587843109716*^9}, {
  3.738587994199336*^9, 3.738587999476156*^9}, {3.73858821041378*^9, 
  3.7385882137956457`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{
      SubscriptBox["f", "bL"], "(", "z", ")"}]}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["z", "2"]}]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["z", "2"], "+", 
       RowBox[{"L", "(", 
        RowBox[{"L", "+", "1"}], ")"}]}], ")"}], 
     SuperscriptBox["z", "2"]], 
    RowBox[{
     SubscriptBox["f", "bL"], "(", "z", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.73858785295756*^9, 3.738587862892911*^9}, {
  3.738588008308414*^9, 3.738588010899756*^9}, {3.738588215883404*^9, 
  3.7385882173394136`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SubscriptBox["f", "bL"], "(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]]}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"L", "(", 
        RowBox[{"L", "+", "1"}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}], "2"]], "+", 
      "1"}], ")"}], 
    RowBox[{
     SubscriptBox["f", "bL"], "(", 
     RowBox[{
      SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}], "r", " ", 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "E"}]]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738587699602828*^9, 3.738587709031705*^9}, {
  3.738588014499772*^9, 3.738588033387149*^9}, {3.7385882197477093`*^9, 
  3.7385882228672*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["\[CapitalPhi]", "i\[Alpha]"]}], 
     RowBox[{"\[DifferentialD]", "r"}]]}], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], "\[Times]", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", "L"], "(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["k", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"L", "(", 
                 RowBox[{"L", "+", "1"}], ")"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["k", "\[Alpha]"], "r"}], ")"}], "2"]], "-", 
               "1"}], ")"}], 
             RowBox[{
              SubscriptBox["f", "L"], "(", 
              RowBox[{
               SubscriptBox["k", "\[Alpha]"], "r"}], ")"}], 
             SubscriptBox["k", "\[Alpha]"], "r", " ", 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["k", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}]}], 
           RowBox[{"E", ">", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]},
          {
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               RowBox[{
                SubscriptBox["f", 
                 RowBox[{"b", " ", "L"}]], "(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}], 
              RowBox[{"\[DifferentialD]", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}]}]], 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"L", "(", 
                 RowBox[{"L", "+", "1"}], ")"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}], "2"]], 
               "+", "1"}], ")"}], 
             RowBox[{
              SubscriptBox["f", "bL"], "(", 
              RowBox[{
               SubscriptBox["\[Kappa]", "\[Alpha]"], "r"}], ")"}], 
             SubscriptBox["\[Kappa]", "\[Alpha]"], "r", " ", 
             FractionBox[
              RowBox[{"\[DifferentialD]", 
               SubscriptBox["\[Kappa]", "\[Alpha]"]}], 
              RowBox[{"\[DifferentialD]", "E"}]]}]}], 
           RowBox[{"E", "<", 
            SubscriptBox["\[Epsilon]", "\[Alpha]"]}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], "   "}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738587396244842*^9, 3.738587421634754*^9}, {
  3.73858746015174*^9, 3.738587464013027*^9}, {3.738587728466826*^9, 
  3.7385877602809963`*^9}, {3.738588036796095*^9, 3.7385880392190437`*^9}, {
  3.7385882287414722`*^9, 3.738588238626457*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["g", "b"]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", "?"}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{3.7386044308807507`*^9}],

Cell[TextData[{
 "Now we have the bound exterior function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"\[Kappa]", "=", 
     SqrtBox[
      RowBox[{"2", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"\[Epsilon]th", "-", "E"}], ")"}]}]]}], ")"}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.738588072888085*^9, 3.738588082352728*^9}, {
  3.7385882953058167`*^9, 3.7385883072840137`*^9}, {3.738604453907647*^9, 
  3.738604464587035*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     RowBox[{
      SubscriptBox["g", "b"], "(", 
      RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", 
       RowBox[{"(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]], "r", " ", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "\[Kappa]"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["g", "b"], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]], "r", " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "\[Kappa]"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         RowBox[{
          SubscriptBox["g", "b"], "(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]], "r", " ", 
       FractionBox["1", 
        RowBox[{"2", "\[Kappa]"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "\[Mu]"}], ")"}]}], "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[DifferentialD]", 
          RowBox[{
           SubscriptBox["g", "b"], "(", 
           RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
         RowBox[{"\[DifferentialD]", 
          RowBox[{"(", 
           RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]]}], " ", 
       FractionBox[
        RowBox[{"\[Mu]", " ", "r"}], "\[Kappa]"]}]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385880879786453`*^9, 3.738588136623024*^9}, {
  3.738588291535769*^9, 3.7385883546376963`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     RowBox[{
      SubscriptBox["g", "b"], "(", 
      RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", 
       RowBox[{"(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]]}], " ", 
    FractionBox[
     RowBox[{"\[Mu]", " ", "r"}], "\[Kappa]"]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385883596222687`*^9, 3.7385883645736732`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{"f", "(", 
        RowBox[{"k", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "E"}]], ",", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{"g", "(", 
        RowBox[{"k", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], ")"}], "=", "?"}], 
  TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.7385883910617313`*^9, 3.73858847472646*^9}}],

Cell[TextData[{
 "Now the open-channel exterior functions with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    SqrtBox[
     RowBox[{"2", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"E", "-", "\[Epsilon]th"}], ")"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.738588531870234*^9, 3.7385885517953176`*^9}, {
  3.7386044833940983`*^9, 3.7386044863382607`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     RowBox[{"f", "(", 
      RowBox[{"k", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{"f", "(", 
        RowBox[{"k", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", 
       RowBox[{"(", 
        RowBox[{"k", " ", "r"}], ")"}]}]], "r", " ", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "k"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{"f", "(", 
        RowBox[{"k", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", 
       RowBox[{"(", 
        RowBox[{"k", " ", "r"}], ")"}]}]], 
     FractionBox[
      RowBox[{"\[Mu]", " ", "r", " "}], "k"]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385884846932907`*^9, 3.738588523575622*^9}, {
  3.738588556425088*^9, 3.738588572469914*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     RowBox[{"f", "(", 
      RowBox[{"k", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{"f", "(", 
       RowBox[{"k", " ", "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{"k", " ", "r"}], ")"}]}]], 
    FractionBox[
     RowBox[{"\[Mu]", " ", "r", " "}], "k"]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7385885858216267`*^9, 3.738588588999778*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     RowBox[{"g", "(", 
      RowBox[{"k", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", "E"}]], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", 
      RowBox[{"g", "(", 
       RowBox[{"k", " ", "r"}], ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{"(", 
       RowBox[{"k", " ", "r"}], ")"}]}]], 
    FractionBox[
     RowBox[{"\[Mu]", " ", "r", " "}], "k"]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738588594636985*^9, 3.738588601997971*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["\[DifferentialD]", 
      RowBox[{"\[DifferentialD]", "E"}]], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "f"}], 
       RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", "?"}], 
   TraditionalForm]]],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    SqrtBox[
     RowBox[{
      RowBox[{"2", "\[Mu]", " ", "E"}], "-", 
      RowBox[{"2", "\[Mu]", " ", "\[Epsilon]th"}]}]]}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.7386047983667803`*^9, 3.73860481556616*^9}, {
  3.739208589718272*^9, 3.739208590456625*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "f"}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["\[DifferentialD]", 
      RowBox[{"\[DifferentialD]", "E"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         RowBox[{"f", "(", 
          RowBox[{"k", " ", "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"(", 
          RowBox[{"k", " ", "r"}], ")"}]}]], "k"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[DifferentialD]", "2"], 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"k", " ", "r"}], ")"}], "2"]}]], "k", " ", "r", "  ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "k"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}]}]], " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "k"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738604841051152*^9, 3.7386048839580717`*^9}, {
  3.738604922405423*^9, 3.738604922565939*^9}, {3.739208595162859*^9, 
  3.7392085954425383`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}]}]], "k"}], ")"}]}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", "k"}], 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         RowBox[{"f", "(", 
          RowBox[{"k", " ", "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"k", " ", "r"}], ")"}], "2"]}]], "k", " ", "r"}], "  ", 
      "+", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}]}]]}], " ", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738604888776394*^9, 3.738604898381661*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}]}]], "k"}], ")"}]}], "=", 
   RowBox[{
    FractionBox["\[Mu]", "k"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"L", "(", 
           RowBox[{"L", "+", "1"}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"k", " ", "r"}], ")"}], "2"]], "-", "1"}], ")"}], 
       RowBox[{"f", "(", 
        RowBox[{"k", " ", "r"}], ")"}], " ", "k", " ", "r"}], "  ", "+", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}]}]]}], " ", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{
  3.7386049025929117`*^9, {3.738604936822064*^9, 3.7386049382038803`*^9}, {
   3.738605023459395*^9, 3.738605042736134*^9}}],

Cell["Finally, we need:", "Text",
 CellChangeTimes->{{3.738604375604545*^9, 3.738604379127901*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Kappa]", "=", 
    SqrtBox[
     RowBox[{"2", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]th", "-", "E"}], ")"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsection",
 CellChangeTimes->{{3.738604381463635*^9, 3.738604415649135*^9}, {
  3.738604505274959*^9, 3.738604526128954*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["\[DifferentialD]", 
      RowBox[{"\[DifferentialD]", "E"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", 
         RowBox[{
          SubscriptBox["g", "b"], "(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         RowBox[{"(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]], "\[Kappa]"}], ")"}]}], 
    "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["\[DifferentialD]", "2"], 
        RowBox[{
         SubscriptBox["g", "b"], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}], "2"]}]], "\[Kappa]", " ", 
      "r", "  ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "\[Kappa]"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["g", "b"], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]], " ", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "\[Kappa]"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738604549847148*^9, 3.738604667173162*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[DifferentialD]", "\[Kappa]"}], 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[DifferentialD]", "2"], 
         RowBox[{
          SubscriptBox["g", "b"], "(", 
          RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Kappa]", " ", "r"}], ")"}], "2"]}]], "\[Kappa]", " ", 
       "r"}], "  ", "+", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["g", "b"], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]]}], " ", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738604672982991*^9, 3.738604685906048*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Mu]", "\[Kappa]"]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"L", "(", 
           RowBox[{"L", "+", "1"}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Kappa]", " ", "r"}], ")"}], "2"]], "+", "1"}], ")"}], 
       RowBox[{
        SubscriptBox["g", "b"], "(", 
        RowBox[{"\[Kappa]", " ", "r"}], ")"}], "\[Kappa]", " ", "r"}], "  ", 
      "+", 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        RowBox[{
         SubscriptBox["g", "b"], "(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}], 
       RowBox[{"\[DifferentialD]", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", " ", "r"}], ")"}]}]]}], " ", ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738604700377565*^9, 3.738604724949932*^9}, {
  3.738605094552641*^9, 3.738605120132031*^9}}],

Cell[TextData[{
 "Okay, now we have all we need to construct the ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[DifferentialD]", "A"}], 
    RowBox[{"\[DifferentialD]", "E"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " matrix."
}], "Text",
 CellChangeTimes->{{3.738588630073617*^9, 3.738588648673718*^9}}],

Cell["\<\
Okay these are coded up in both Mathematica and fortran and working!  See \
MyNchannelSqrWell-EnergyNormalized.nb and squarenew.f90 from 6/28/18.\
\>", "Text",
 CellChangeTimes->{{3.739325774336369*^9, 3.739325852559779*^9}}],

Cell["", "Text",
 CellChangeTimes->{{3.739325774336369*^9, 3.739325852807726*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
derivative of the time delay? (useful for finding resonance positions...\
\>", "Section",
 CellChangeTimes->{{3.739325774336369*^9, 3.739325887034071*^9}}],

Cell["Taking another derivative of the equation:", "Text",
 CellChangeTimes->{{3.739535216320242*^9, 3.739535223074813*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"A", " ", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]], "x"}]}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.739535213894747*^9}],

Cell["gives", "Text",
 CellChangeTimes->{{3.739535224657322*^9, 3.7395352262991323`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", 
    FractionBox[
     RowBox[{"\[DifferentialD]", "x"}], 
     RowBox[{"\[DifferentialD]", "E"}]]}], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "x"}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7395770468602953`*^9, 3.739577053610569*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"A", " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], "x"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["E", "2"]}]]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "A"}], 
       RowBox[{"\[DifferentialD]", "E"}]]}], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], "A"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["E", "2"]}]], "x"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739577059601263*^9, 3.739577115442833*^9}, 
   3.739625833244095*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], "x"}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["E", "2"]}]]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "A"}], 
      RowBox[{"\[DifferentialD]", "E"}]], 
     FractionBox[
      RowBox[{"\[DifferentialD]", "x"}], 
      RowBox[{"\[DifferentialD]", "E"}]]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "2"], "A"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["E", "2"]}]], "x"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.73953527949057*^9, 3.73953529788179*^9}, {
  3.739577358989189*^9, 3.739577367962556*^9}, {3.7396258427143927`*^9, 
  3.7396258466239157`*^9}}],

Cell[TextData[{
 "The critical new quantity we need is the matrix ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], "A"}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["E", "2"]}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", where again "
}], "Text",
 CellChangeTimes->{{3.739325932936371*^9, 3.739325979083439*^9}, {
  3.739535304295739*^9, 3.739535336903302*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"A", "=", 
   RowBox[{"(", GridBox[{
      {
       StyleBox[
        SubscriptBox["\[CapitalPhi]", "11"],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        SubscriptBox["\[CapitalPhi]", 
         RowBox[{"1", "N"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        RowBox[{"-", 
         SubscriptBox["g", "1"]}],
        FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
      {
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", "11"]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", 
           RowBox[{"1", "N"}]]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["g", "1"]}], 
          RowBox[{"\[PartialD]", "r"}]]}],
        FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
      {
       StyleBox["\[VerticalEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[DescendingEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[VerticalEllipsis]",
        FontColor->RGBColor[1, 0, 0]], "0", "\[DescendingEllipsis]", "0", "0",
        "0"},
      {
       StyleBox[
        SubscriptBox["\[CapitalPhi]", 
         RowBox[{
          RowBox[{"N", "-", "1"}], ",", "1"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        SubscriptBox["\[CapitalPhi]", 
         RowBox[{
          RowBox[{"N", "-", "1"}], ",", "N"}]],
        FontColor->RGBColor[1, 0, 0]], "0", "0", 
       StyleBox[
        RowBox[{"-", 
         SubscriptBox["g", 
          RowBox[{"N", "-", "1"}]]}],
        FontColor->RGBColor[0, 0, 1]], "0", "0"},
      {
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", 
           RowBox[{
            RowBox[{"N", "-", "1"}], ",", "1"}]]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", 
           RowBox[{
            RowBox[{"N", "-", "1"}], ",", "N"}]]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], "0", "0", 
       StyleBox[
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[PartialD]", 
           SubscriptBox["g", 
            RowBox[{"N", "-", "1"}]]}], 
          RowBox[{"\[PartialD]", "r"}]]}],
        FontColor->RGBColor[0, 0, 1]], "0", "0"},
      {
       StyleBox[
        SubscriptBox["\[CapitalPhi]", "N1"],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        SubscriptBox["\[CapitalPhi]", "NN"],
        FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
       RowBox[{"-", 
        SubscriptBox["f", "o"]}], 
       SubscriptBox["g", "o"]},
      {
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", "N1"]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["\[CenterEllipsis]",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox[
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["\[CapitalPhi]", "NN"]}], 
         RowBox[{"\[PartialD]", "r"}]],
        FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[PartialD]", 
          SubscriptBox["f", "o"]}], 
         RowBox[{"\[PartialD]", "r"}]]}], 
       FractionBox[
        RowBox[{"\[PartialD]", 
         SubscriptBox["g", "o"]}], 
        RowBox[{"\[PartialD]", "r"}]]},
      {"0", "0", "0", "0", "0", "0", "1", "0"}
     }], ")"}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.73953534011592*^9, 3.739535341671301*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalPhi]", "i\[Alpha]"], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], 
    RowBox[{
     SubscriptBox["f", "\[Alpha]"], "(", 
     RowBox[{
      SubscriptBox["k", "\[Alpha]"], "r"}], ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739535359831542*^9, 3.73953537631808*^9}}],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], "f"}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["E", "2"]}]], "=", "?"}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.739325932936371*^9, 3.739326025977168*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{"f", "(", 
      RowBox[{"k", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["E", "2"]}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox["\[DifferentialD]", 
      RowBox[{"\[DifferentialD]", "E"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"f", "'"}], 
       RowBox[{"(", 
        RowBox[{"k", " ", "r"}], ")"}], " ", "r", 
       FractionBox[
        RowBox[{"\[PartialD]", "k"}], 
        RowBox[{"\[PartialD]", "E"}]]}], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "''"}], 
      RowBox[{"(", 
       RowBox[{"k", " ", "r"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["r", "2"], "(", 
        FractionBox[
         RowBox[{"\[PartialD]", "k"}], 
         RowBox[{"\[PartialD]", "E"}]], ")"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"f", "'"}], "r", " ", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[PartialD]", "2"], "k"}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["E", "2"]}]]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739326155288755*^9, 3.739326287311409*^9}}],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[DifferentialD]", "2"], 
      RowBox[{
       SubscriptBox["f", "L"], "(", "z", ")"}]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["z", "2"]}]], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"L", "(", 
         RowBox[{"L", "+", "1"}], ")"}], 
        SuperscriptBox["z", "2"]], "-", "1"}], ")"}], 
     SubscriptBox["f", "L"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.739326332857502*^9, 3.739326334122978*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{"f", "(", 
      RowBox[{"k", " ", "r"}], ")"}]}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["E", "2"]}]], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"L", "(", 
         RowBox[{"L", "+", "1"}], ")"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"k", " ", "r"}], ")"}], "2"]], "-", "1"}], ")"}], "f", " ", 
     
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["r", "2"], "(", 
       FractionBox[
        RowBox[{"\[PartialD]", "k"}], 
        RowBox[{"\[PartialD]", "E"}]], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"f", "'"}], "r", " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "2"], "k"}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["E", "2"]}]]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7393263442593937`*^9, 3.7393263616949167`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Together", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "e"}], "]"}], 
        ",", "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "''"}], "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"L", "(", 
              RowBox[{"L", "+", "1"}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", "1"}],
            ")"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"f", "'"}], "\[Rule]", "fprime"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"fprime", "[", 
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{"drj", " "}], 
       RowBox[{"k", "[", "e", "]"}]]}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
       FractionBox["twomu", 
        RowBox[{"2", " ", "ek"}]]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rj"}]}]], "Input",
 CellChangeTimes->{{3.7395357908857803`*^9, 3.73953585525825*^9}, {
  3.739536096701679*^9, 3.7395361474255133`*^9}, {3.739544261131081*^9, 
  3.7395442803630543`*^9}, {3.739547758266725*^9, 3.739547774145084*^9}, {
  3.739571814623414*^9, 3.7395718566732903`*^9}, {3.739571913963584*^9, 
  3.739571969882916*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"drj", " ", "r"}], "-", 
      RowBox[{"L", " ", "rj"}], "-", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "rj"}], "+", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", 
       SuperscriptBox["r", "2"], " ", "rj"}]}], ")"}], " ", 
    SuperscriptBox["twomu", "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["ek", "4"]}]]}]], "Output",
 CellChangeTimes->{
  3.739535859796681*^9, {3.7395361215568438`*^9, 3.739536148924844*^9}, 
   3.739544281168783*^9, 3.73954777507614*^9, {3.739571816560801*^9, 
   3.739571825575777*^9}, 3.7395718575608397`*^9, {3.739571901671164*^9, 
   3.7395719155059347`*^9}, {3.739571952785605*^9, 3.739571970277542*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.73957189090641*^9, 3.739571899808641*^9}}],

Cell["\<\
-((drj*r - L*rj - L**2*rj + ek**2*r**2*rj)*twomu**2)/(4.*ek**4)\
\>", "Output",
 CellChangeTimes->{3.7395719024538383`*^9, 3.7395719736629457`*^9}]
}, Open  ]],

Cell[TextData[{
 "For real values, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    SqrtBox[
     RowBox[{"2", 
      RowBox[{"\[Mu]", "(", 
       RowBox[{"E", "-", "\[Epsilon]"}], ")"}]}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", "\[Epsilon]th"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for the exterior open-channel solutions and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", 
    SubscriptBox["\[CapitalLambda]", "\[Alpha]\[Alpha]"]}], TraditionalForm]],
  
  FormatType->"TraditionalForm"],
 " for the interior eigen-solutions"
}], "Text",
 CellChangeTimes->{{3.739535420660287*^9, 3.7395355111503887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{"twomu", 
        RowBox[{"(", 
         RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     SuperscriptBox["k", "2"]}]}], ",", 
   RowBox[{"k", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739538123986546*^9, 3.7395381316216793`*^9}}],

Cell[BoxData[
 FractionBox["twomu", 
  RowBox[{"2", " ", "k"}]]], "Output",
 CellChangeTimes->{3.739538132126124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{"twomu", 
          RowBox[{"(", 
           RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}], 
      ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     SuperscriptBox["k", "2"]}]}], ",", 
   RowBox[{"k", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7395359546779222`*^9, 3.7395360383222523`*^9}, {
  3.739537242328747*^9, 3.739537321250513*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["twomu", "2"], 
   RowBox[{"4", " ", 
    SuperscriptBox["k", "3"]}]]}]], "Output",
 CellChangeTimes->{{3.739535977455923*^9, 3.739536038751066*^9}, 
   3.7395372452586823`*^9, 3.739537275390665*^9, {3.739537307839052*^9, 
   3.7395373224742413`*^9}, 3.73954428493486*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{"twomu", 
            RowBox[{"(", 
             RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}],
         ",", "Energy"}], "]"}], ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     SuperscriptBox["k", "2"]}]}], ",", 
   RowBox[{"k", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7396354063993673`*^9, 3.739635414424755*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["twomu", "3"]}], 
  RowBox[{"8", " ", 
   SuperscriptBox["k", "5"]}]]], "Output",
 CellChangeTimes->{3.7396354152379103`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "2"], 
     SubscriptBox["f", "b"]}], 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["E", "2"]}]], "=", "?"}], TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.7395363021423883`*^9, 3.739536307042633*^9}}],

Cell["For the exponential-type functions", "Text",
 CellChangeTimes->{{3.739536309944879*^9, 3.7395363169775667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "e"}], "]"}], ",",
        "e"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"f", "''"}], "[", 
         RowBox[{
          RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"L", "(", 
             RowBox[{"L", "+", "1"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}], 
          ")"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"f", "'"}], "\[Rule]", "fprime"}]}], "}"}]}], "/.", 
    RowBox[{"fprime", "\[Rule]", 
     FractionBox[
      RowBox[{"dfdr", " "}], 
      RowBox[{"k", "[", "e", "]"}]]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "e", "]"}], "\[Rule]", "k"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
      FractionBox["twomu", 
       RowBox[{"2", " ", "k"}]]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["twomu", "2"], 
        RowBox[{"4", " ", 
         SuperscriptBox["k", "3"]}]]}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.739545390488716*^9, {3.7395606571030617`*^9, 3.739560659837536*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["twomu", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"L", " ", 
      RowBox[{"f", "[", 
       RowBox[{"k", " ", "r"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["L", "2"], " ", 
      RowBox[{"f", "[", 
       RowBox[{"k", " ", "r"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["k", "2"], " ", 
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"f", "[", 
       RowBox[{"k", " ", "r"}], "]"}]}], "-", 
     RowBox[{"k", " ", "r", " ", 
      RowBox[{
       FractionBox["dfdr", "k"], "[", 
       RowBox[{"k", " ", "r"}], "]"}]}]}], ")"}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["k", "4"]}]]], "Output",
 CellChangeTimes->{3.739545390933132*^9, 3.739560660263878*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{
  3.7395363378085413`*^9, {3.739536368526342*^9, 3.73953639277936*^9}, {
   3.739538146539463*^9, 3.739538171901668*^9}, 3.73956089624222*^9}],

Cell["\<\
        (twomu**2*(L*f(k*r) + L**2*f(k*r) + k**2*r**2*f(k*r) - 
     -      k*r*(dfdr/k)(k*r)))/(4.*k**4)\
\>", "Output",
 CellChangeTimes->{
  3.7395363972958393`*^9, {3.7395381613326187`*^9, 3.7395381743015833`*^9}, 
   3.739560896954228*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["E", "2"]}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", "f"}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", "?"}], 
  TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.739325932936371*^9, 3.739326057262875*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[DifferentialD]", 
       RowBox[{"\[DifferentialD]", "E"}]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[DifferentialD]", "f"}], 
        RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], ")"}]}], "=", 
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[Mu]", "k"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"L", "(", 
             RowBox[{"L", "+", "1"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"k", " ", "r"}], ")"}], "2"]], "-", "1"}], ")"}], 
         RowBox[{"f", "(", 
          RowBox[{"k", " ", "r"}], ")"}], " ", "k", " ", "r"}], "  ", "+", 
        RowBox[{
         RowBox[{"f", "'"}], 
         RowBox[{"(", 
          RowBox[{"k", " ", "r"}], ")"}]}]}], " ", ")"}]}], ")"}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739326462389327*^9, 3.739326504258773*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["\[DifferentialD]", 
     RowBox[{"\[DifferentialD]", "E"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[DifferentialD]", 
       RowBox[{"\[DifferentialD]", "E"}]], 
      RowBox[{"(", 
       FractionBox[
        RowBox[{"\[DifferentialD]", "f"}], 
        RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], ")"}]}], "=", 
   RowBox[{"\[Mu]", " ", 
    RowBox[{
     FractionBox["\[DifferentialD]", 
      RowBox[{"\[DifferentialD]", "E"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"L", "(", 
            RowBox[{"L", "+", "1"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"k", " ", "r"}], ")"}], "2"]], "-", "1"}], ")"}], 
        RowBox[{"f", "(", 
         RowBox[{"k", " ", "r"}], ")"}], "  ", "r"}], " ", "+", 
       RowBox[{
        RowBox[{"f", "'"}], 
        RowBox[{"(", 
         RowBox[{"k", " ", "r"}], ")"}], " ", 
        FractionBox["1", "k"]}]}], ")"}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739326550502222*^9, 3.7393265810467777`*^9}, {
  3.73932663878347*^9, 3.739326646621294*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"thirdderiv", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"L", "(", 
                 RowBox[{"L", "+", "1"}], ")"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"k", "[", "e", "]"}], " ", "r"}], ")"}], "2"]], 
               "-", "1"}], ")"}], 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], "r"}], " ", 
            "+", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "'"}], "[", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], " ", 
             FractionBox["1", 
              RowBox[{"k", "[", "e", "]"}]]}]}], ")"}], ",", 
          RowBox[{"k", "[", "e", "]"}]}], "]"}], 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"k", "[", "e", "]"}], ",", "e"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f", "''"}], "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"L", "(", 
               RowBox[{"L", "+", "1"}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", 
             "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"f", "'"}], "\[Rule]", "fprime"}]}], "}"}]}], "/.", 
      RowBox[{
       RowBox[{"fprime", "[", 
        RowBox[{
         RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], "\[Rule]", 
       FractionBox[
        RowBox[{"drj", " "}], 
        RowBox[{"k", "[", "e", "]"}]]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
       FractionBox["twomu", 
        RowBox[{"2", " ", "ek"}]]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "/.", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rj"}]}]}]], "Input",
 CellChangeTimes->{{3.7393266652183847`*^9, 3.739326825062573*^9}, {
   3.739326878664176*^9, 3.7393268806608*^9}, {3.7393269358038397`*^9, 
   3.739326942752821*^9}, {3.7393272120826597`*^9, 3.739327271303441*^9}, {
   3.739536190181487*^9, 3.739536190475895*^9}, 3.739538230819233*^9, {
   3.7395720286771383`*^9, 3.739572106595052*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "drj"}], " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "L", "+", 
         SuperscriptBox["L", "2"], "-", 
         RowBox[{
          SuperscriptBox["ek", "2"], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"L", "+", 
         SuperscriptBox["L", "2"], "+", 
         RowBox[{
          SuperscriptBox["ek", "2"], " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", "rj"}]}], ")"}], " ", 
    "twomu"}], 
   RowBox[{"2", " ", 
    SuperscriptBox["ek", "4"], " ", "r"}]]}]], "Output",
 CellChangeTimes->{
  3.739326709439056*^9, {3.739326749517849*^9, 3.739326757838105*^9}, 
   3.739326837681699*^9, 3.739326884357636*^9, 3.739326948436664*^9, {
   3.7393272484555807`*^9, 3.739327273167519*^9}, 3.739536191267247*^9, 
   3.7395382316355124`*^9, {3.739572040919351*^9, 3.739572106953121*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", "thirdderiv", "]"}]], "Input",
 CellChangeTimes->{{3.739326886195451*^9, 3.7393268982208157`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"twomu", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rj", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["ek", "2"], " ", 
           SuperscriptBox["r", "2"]}], "+", 
          SuperscriptBox["L", "2"], "+", "L"}], ")"}]}], "-", 
       RowBox[{"drj", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            SuperscriptBox["ek", "2"], " ", 
            SuperscriptBox["r", "2"]}]}], "+", 
          SuperscriptBox["L", "2"], "+", "L", "-", "1"}], ")"}]}]}], ")"}]}], 
    
    RowBox[{"2", " ", 
     SuperscriptBox["ek", "4"], " ", "r"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.73932689911579*^9, 3.739326955545454*^9, 
  3.739534853542758*^9, 3.739536198220536*^9, 3.739538249245273*^9, 
  3.739572211098633*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "thirdderiv", "]"}]], "Input",
 CellChangeTimes->{{3.7393269006917267`*^9, 3.739326905980111*^9}}],

Cell["\<\
        -((-(drj*r*(-1 + L + L**2 - ek**2*r**2)) + 
     -       (L + L**2 + ek**2*r**2)*rj)*twomu)/(2.*ek**4*r)\
\>", "Output",
 CellChangeTimes->{3.739326906446271*^9, 3.739534855747569*^9, 
  3.7395361989898376`*^9, 3.739538254780822*^9, 3.739572213780855*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"-", "twomu"}], 
        RowBox[{"(", 
         RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     RowBox[{"-", 
      SuperscriptBox["\[Kappa]", "2"]}]}]}], ",", 
   RowBox[{"\[Kappa]", ">", "0"}]}], "]"}], "\n", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"-", "twomu"}], 
          RowBox[{"(", 
           RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}], 
      ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     RowBox[{"-", 
      SuperscriptBox["\[Kappa]", "2"]}]}]}], ",", 
   RowBox[{"\[Kappa]", ">", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.739538416752389*^9, 3.739538465605528*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"-", "twomu"}], 
            RowBox[{"(", 
             RowBox[{"Energy", "-", "eps"}], ")"}]}]], ",", "Energy"}], "]"}],
         ",", "Energy"}], "]"}], ",", "Energy"}], "]"}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Energy", "-", "eps"}], ")"}], " ", "twomu"}], "\[Rule]", 
     RowBox[{"-", 
      SuperscriptBox["\[Kappa]", "2"]}]}]}], ",", 
   RowBox[{"\[Kappa]", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739635692367311*^9, 3.7396356998526907`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["twomu", "3"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["\[Kappa]", "5"]}]]}]], "Output",
 CellChangeTimes->{{3.739538456391632*^9, 3.739538466124915*^9}, 
   3.739635700676817*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[DifferentialD]", "2"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["E", "2"]}]], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[DifferentialD]", 
       SubscriptBox["f", "b"]}], 
      RowBox[{"\[DifferentialD]", "r"}]], ")"}]}], "=", "?"}], 
  TraditionalForm]],
 FormatType->"TraditionalForm"]], "Subsection",
 CellChangeTimes->{{3.7395364318207607`*^9, 3.739536438300787*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "\[Kappa]", ",", "e"}], "]"}]], "Input",
 CellChangeTimes->{{3.739536865213708*^9, 3.739536882583158*^9}, {
  3.739538377067671*^9, 3.73953837751682*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"ek", "[", "e", "]"}], " ", "r"}], "]"}], ",", "r"}], 
            "]"}], ",", "e"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "''"}], "[", 
            RowBox[{
             RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"L", "(", 
                RowBox[{"L", "+", "1"}], ")"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", 
              "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
        "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "''"}], "[", 
         RowBox[{
          RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}], "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"L", "(", 
             RowBox[{"L", "+", "1"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}],
           ")"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "''"}], "[", 
        RowBox[{
         RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}], "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"L", "(", 
            RowBox[{"L", "+", "1"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}], 
         ")"}], 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ek", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ek", "'"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox["twomu", 
         RowBox[{"2", " ", "ek"}]]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ek", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "ri"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "'"}], "[", 
      RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "dri"}]}], "}"}]}]], "Input",\

 CellChangeTimes->{{3.739536769542336*^9, 3.739536860070877*^9}, {
   3.739536895563155*^9, 3.739536994510841*^9}, {3.739537107545144*^9, 
   3.739537118280006*^9}, {3.739537149149373*^9, 3.73953715160413*^9}, 
   3.739537226815494*^9, {3.7395383205438423`*^9, 3.739538322734747*^9}, {
   3.739538380868743*^9, 3.739538410304865*^9}, {3.739538476413827*^9, 
   3.739538514574404*^9}, {3.739538591146768*^9, 3.739538669502512*^9}, {
   3.7395388260900383`*^9, 3.739538845484404*^9}, {3.739538887110371*^9, 
   3.739538887499485*^9}, {3.7395389186620493`*^9, 3.739538981540985*^9}, {
   3.7395447402921677`*^9, 3.739544817697028*^9}, {3.739544895262351*^9, 
   3.7395448969393787`*^9}, {3.739545454145059*^9, 3.739545458776271*^9}, {
   3.739572381456398*^9, 3.739572409860302*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dri", " ", "ek", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "L", "+", 
        SuperscriptBox["L", "2"], "+", 
        RowBox[{
         SuperscriptBox["ek", "2"], " ", 
         SuperscriptBox["r", "2"]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "+", 
        SuperscriptBox["L", "2"], "-", 
        RowBox[{
         SuperscriptBox["ek", "2"], " ", 
         SuperscriptBox["r", "2"]}]}], ")"}], " ", "ri"}]}], ")"}], " ", 
   SuperscriptBox["twomu", "2"]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["ek", "4"], " ", "r"}]]], "Output",
 CellChangeTimes->{
  3.739536805831766*^9, {3.739536847119216*^9, 3.7395368842350817`*^9}, {
   3.739536935753675*^9, 3.739536948971299*^9}, 3.739537006131559*^9, {
   3.739537111531293*^9, 3.7395371187224407`*^9}, 3.739537152418371*^9, 
   3.7395372286176662`*^9, {3.739538304836874*^9, 3.7395383231493597`*^9}, {
   3.7395384930339108`*^9, 3.739538515001087*^9}, {3.739538606225113*^9, 
   3.73953866998555*^9}, {3.739538827117633*^9, 3.739538851059025*^9}, 
   3.739538887979401*^9, {3.73953897578094*^9, 3.739538982030418*^9}, {
   3.739544814532165*^9, 3.739544818666541*^9}, 3.739544897372617*^9, 
   3.739545459307248*^9, {3.7395724108636827`*^9, 3.739572429337489*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.739572421010624*^9, 3.739572428022933*^9}}],

Cell["\<\
        ((dri*ek*r*(-1 + L + L**2 + ek**2*r**2) - 
     -      (L + L**2 - ek**2*r**2)*ri)*twomu**2)/(4.*ek**4*r)\
\>", "Output",
 CellChangeTimes->{{3.739572424307364*^9, 3.739572430086903*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"ek", "[", "e", "]"}], " ", "r"}], "]"}], ",", "e"}], 
         "]"}], ",", "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "''"}], "[", 
         RowBox[{
          RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}], "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"L", "(", 
             RowBox[{"L", "+", "1"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}],
           ")"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "''"}], "[", 
        RowBox[{
         RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}], "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"L", "(", 
            RowBox[{"L", "+", "1"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}], 
         ")"}], 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ek", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ek", "'"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox["twomu", 
         RowBox[{"2", " ", "ek"}]]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ek", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "ri"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "'"}], "[", 
      RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", 
     RowBox[{"dri", "/", "ek"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.739572502258215*^9, 3.7395725300403843`*^9}, {
  3.739573304320539*^9, 3.7395733232731028`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dri"}], " ", "r"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"L", "+", 
        SuperscriptBox["L", "2"], "+", 
        RowBox[{
         SuperscriptBox["ek", "2"], " ", 
         SuperscriptBox["r", "2"]}]}], ")"}], " ", "ri"}]}], ")"}], " ", 
   SuperscriptBox["twomu", "2"]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["ek", "4"]}]]], "Output",
 CellChangeTimes->{
  3.7395725343054256`*^9, {3.73957330566323*^9, 3.739573326568603*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.739572539898486*^9, 3.739572546066806*^9}}],

Cell["\<\
((-(dri*ek*r) + (L + L**2 + ek**2*r**2)*ri)*twomu**2)/(4.*ek**4)\
\>", "Output",
 CellChangeTimes->{3.7395725465111113`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Third derivative terms for the exterior functions", "Subsection",
 CellChangeTimes->{{3.739573048629168*^9, 3.739573062669758*^9}}],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], ",", "e"}], "]"}],
        ",", "e"}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "''"}], "[", 
        RowBox[{"r", " ", 
         RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"L", "(", 
            RowBox[{"L", "+", "1"}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ek", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}], 
         ")"}], 
        RowBox[{"g", "[", 
         RowBox[{
          RowBox[{"ek", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ek", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox["twomu", 
         RowBox[{"2", " ", "ek"}]]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rk"}], ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"r", " ", 
        RowBox[{"k", "[", "e", "]"}]}], "]"}], "\[Rule]", 
      RowBox[{"drk", "/", "ek"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7395730657433033`*^9, 3.7395731746048813`*^9}, {
  3.739573210507492*^9, 3.7395732624803953`*^9}, {3.7395733926327553`*^9, 
  3.739573426425358*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"drk", " ", "r"}], "-", 
      RowBox[{"L", " ", "rk"}], "-", 
      RowBox[{
       SuperscriptBox["L", "2"], " ", "rk"}], "-", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", 
       SuperscriptBox["r", "2"], " ", "rk"}]}], ")"}], " ", 
    SuperscriptBox["twomu", "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["ek", "4"]}]]}]], "Output",
 CellChangeTimes->{{3.7395731338144083`*^9, 3.739573175017663*^9}, {
   3.7395732290612907`*^9, 3.7395732630406427`*^9}, {3.7395733981556463`*^9, 
   3.739573426879318*^9}, 3.739574407845367*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.739574409742979*^9, 3.739574412903885*^9}}],

Cell["\<\
-((drk*r - L*rk - L**2*rk - ek**2*r**2*rk)*twomu**2)/(4.*ek**4)\
\>", "Output",
 CellChangeTimes->{3.739574413349573*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"g", "[", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], ",", "r"}], 
            "]"}], ",", "e"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "''"}], "[", 
            RowBox[{"r", " ", 
             RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"L", "(", 
                RowBox[{"L", "+", "1"}], ")"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", 
              "1"}], ")"}], 
            RowBox[{"g", "[", 
             RowBox[{
              RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
        "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"g", "''"}], "[", 
         RowBox[{"r", " ", 
          RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"L", "(", 
             RowBox[{"L", "+", "1"}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", "1"}], 
          ")"}], 
         RowBox[{"g", "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox["twomu", 
          RowBox[{"2", " ", "ek"}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["twomu", "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rk"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"r", " ", 
         RowBox[{"k", "[", "e", "]"}]}], "]"}], "\[Rule]", 
       RowBox[{"drk", "/", "ek"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", 
       RowBox[{"drk", "/", "ek"}]}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.739573523289241*^9, 3.739573578372678*^9}, {
  3.7395736202186737`*^9, 3.739573683128304*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "drk"}], " ", "r"}], "+", 
     RowBox[{"drk", " ", "L", " ", "r"}], "+", 
     RowBox[{"drk", " ", 
      SuperscriptBox["L", "2"], " ", "r"}], "+", 
     RowBox[{"drk", " ", 
      SuperscriptBox["ek", "2"], " ", 
      SuperscriptBox["r", "3"]}], "-", 
     RowBox[{"L", " ", "rk"}], "-", 
     RowBox[{
      SuperscriptBox["L", "2"], " ", "rk"}], "+", 
     RowBox[{
      SuperscriptBox["ek", "2"], " ", 
      SuperscriptBox["r", "2"], " ", "rk"}]}], ")"}], " ", 
   SuperscriptBox["twomu", "2"]}], 
  RowBox[{"4", " ", 
   SuperscriptBox["ek", "4"], " ", "r"}]]], "Output",
 CellChangeTimes->{
  3.739573538393153*^9, 3.739573583453734*^9, {3.739573625377976*^9, 
   3.73957368356808*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.7395736885976057`*^9, 3.739573691871271*^9}}],

Cell["\<\
        ((-(drk*r) + drk*L*r + drk*L**2*r + drk*ek**2*r**3 - L*rk - 
     -      L**2*rk + ek**2*r**2*rk)*twomu**2)/(4.*ek**4*r)\
\>", "Output",
 CellChangeTimes->{3.73957369236008*^9}]
}, Open  ]],

Cell["For the open channel,", "Text",
 CellChangeTimes->{{3.739573864571562*^9, 3.7395738675047607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Together", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "e"}], "]"}], 
        ",", "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "''"}], "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{"L", "(", 
              RowBox[{"L", "+", "1"}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", "1"}],
            ")"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"f", "'"}], "\[Rule]", "fprime"}]}], "}"}]}], "/.", 
     RowBox[{
      RowBox[{"fprime", "[", 
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{"df", " "}], 
       RowBox[{"k", "[", "e", "]"}]]}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
       FractionBox["twomu", 
        RowBox[{"2", " ", "ek"}]]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["twomu", "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["ek", "3"]}]]}]}]}], "}"}]}], "]"}], "/.", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "f"}]}]], "Input",
 CellChangeTimes->{{3.739573864571562*^9, 3.7395739020481052`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "f"}], " ", "L"}], "-", 
      RowBox[{"f", " ", 
       SuperscriptBox["L", "2"]}], "+", 
      RowBox[{"df", " ", "r"}], "+", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "f", " ", 
       SuperscriptBox["r", "2"]}]}], ")"}], " ", 
    SuperscriptBox["twomu", "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["ek", "4"]}]]}]], "Output",
 CellChangeTimes->{3.7395739125603533`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.7395739167908087`*^9, 3.739573920255484*^9}}],

Cell["\<\
-((-(f*L) - f*L**2 + df*r + ek**2*f*r**2)*twomu**2)/(4.*ek**4)\
\>", "Output",
 CellChangeTimes->{3.739573920882853*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "fp", "]"}]], "Input",
 CellChangeTimes->{{3.73962135856784*^9, 3.7396213603301907`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Together", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "r"}], "]"}], 
           ",", "e"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"f", "''"}], "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"L", "(", 
                RowBox[{"L", "+", "1"}], ")"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", 
              "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
        "e"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"f", "''"}], "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "\[Rule]", "fpp"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "'"}], "[", 
          RowBox[{
           RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "\[Rule]", "fp"}]}], 
       "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        FractionBox["mu", "ek"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["mu", "2"], 
          SuperscriptBox["ek", "3"]]}]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "f"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.739573968337481*^9, 3.739574010998871*^9}, {
  3.7396207573915377`*^9, 3.739620761589085*^9}, {3.7396207971224527`*^9, 
  3.7396207989684153`*^9}, {3.73962125563246*^9, 3.739621354720847*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["mu", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "f", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "L"}], ")"}]}], "+", 
     RowBox[{"ek", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ek", " ", "fpp", " ", "r"}], "+", 
        RowBox[{"fp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "L", "+", 
           SuperscriptBox["L", "2"], "-", 
           RowBox[{
            SuperscriptBox["ek", "2"], " ", 
            SuperscriptBox["r", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["ek", "4"], " ", "r"}]]], "Output",
 CellChangeTimes->{3.739621361748507*^9, 3.74583726201431*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.7395740366903677`*^9, 3.739574040490622*^9}}],

Cell["\<\
        (mu**2*(-2*f*L*(1 + L) + 
     -      ek*r*(ek*fpp*r + fp*(-1 + L + L**2 - ek**2*r**2))))/(ek**4*r)\
\>", "Output",
 CellChangeTimes->{3.739574040945766*^9, 3.739621378433937*^9, 
  3.745837263812744*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Tan", "[", 
          RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], ",", "EE"}], "]"}], 
       "\[Equal]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", "EE", "]"}], "/", 
          RowBox[{"c", "[", "EE", "]"}]}], ",", "EE"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Delta]", "'"}], "[", "EE", "]"}]}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7396186541081467`*^9, 3.7396187660798197`*^9}, {
  3.7396188108495893`*^9, 3.7396188115852957`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Delta]", "\[Prime]",
     MultilineFunction->None], "[", "EE", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"s", "[", "EE", "]"}]}], " ", 
        RowBox[{
         SuperscriptBox["c", "\[Prime]",
          MultilineFunction->None], "[", "EE", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c", "[", "EE", "]"}], " ", 
        RowBox[{
         SuperscriptBox["s", "\[Prime]",
          MultilineFunction->None], "[", "EE", "]"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"c", "[", "EE", "]"}], "2"]]}], "}"}]], "Output",
 CellChangeTimes->{3.740010747041648*^9, 3.740010827603611*^9, 
  3.745837264886632*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Tan", "[", 
        RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], ",", "EE"}], "]"}], ",", 
     "EE"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7395814411756477`*^9, 3.739581457999206*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Sec", "[", 
    RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"Tan", "[", 
      RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[Delta]", "\[Prime]",
        MultilineFunction->None], "[", "EE", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["\[Delta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "EE", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.739581452550136*^9, 3.739581458403853*^9}, 
   3.7458372660044613`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rhs", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "[", "EE", "]"}], "/", 
        RowBox[{"c", "[", "EE", "]"}]}], ",", "EE"}], "]"}], ",", "EE"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7395814652797613`*^9, 3.7395814855110083`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"s", "[", "EE", "]"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["c", "\[Prime]",
       MultilineFunction->None], "[", "EE", "]"}], "2"]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"c", "[", "EE", "]"}], " ", 
    RowBox[{
     SuperscriptBox["c", "\[Prime]",
      MultilineFunction->None], "[", "EE", "]"}], " ", 
    RowBox[{
     SuperscriptBox["s", "\[Prime]",
      MultilineFunction->None], "[", "EE", "]"}]}], "-", 
   RowBox[{
    RowBox[{"c", "[", "EE", "]"}], " ", 
    RowBox[{"s", "[", "EE", "]"}], " ", 
    RowBox[{
     SuperscriptBox["c", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "EE", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"c", "[", "EE", "]"}], "2"], " ", 
    RowBox[{
     SuperscriptBox["s", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "EE", "]"}]}]}], 
  SuperscriptBox[
   RowBox[{"c", "[", "EE", "]"}], "3"]]], "Output",
 CellChangeTimes->{3.739581492666379*^9, 3.745837266915135*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"lhs", "\[Equal]", "rhs"}], ",", 
      RowBox[{
       RowBox[{"\[Delta]", "''"}], "[", "EE", "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Delta]", "'"}], "[", "EE", "]"}], "\[Rule]", 
    FractionBox["tau", 
     RowBox[{"2", "\[HBar]"}]]}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "EE", "]"}], "\[Rule]", "cd"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "'"}], "[", "EE", "]"}], "\[Rule]", "dcde"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "'"}], "[", "EE", "]"}], "\[Rule]", "dsde"}], ",", 
    RowBox[{
     RowBox[{"s", "[", "EE", "]"}], "\[Rule]", "sd"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "''"}], "[", "EE", "]"}], "\[Rule]", "d2c"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "''"}], "[", "EE", "]"}], "\[Rule]", "d2s"}], ",", 
    RowBox[{
     RowBox[{"Tan", "[", 
      RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "\[Rule]", 
     RowBox[{"sd", "/", "cd"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7395757368298807`*^9, 3.739575753952057*^9}, {
  3.739581360987376*^9, 3.739581393387238*^9}, {3.739581512653226*^9, 
  3.739581538889968*^9}, {3.73961856358039*^9, 3.739618575205735*^9}, {
  3.739618771816889*^9, 3.739618863589347*^9}, {3.739618906196254*^9, 
  3.7396189127498817`*^9}, {3.740013986418564*^9, 3.7400139937039013`*^9}, {
  3.745837214554275*^9, 3.7458372174227543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Delta]", "\[Prime]\[Prime]",
    MultilineFunction->None], "[", "EE", "]"}], "\[Rule]", 
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["cd", "2"], " ", "sd", " ", 
       SuperscriptBox["tau", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[HBar]", "2"]}]]}], "+", 
    RowBox[{
     SuperscriptBox["cd", "2"], " ", "d2s", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "-", 
    RowBox[{"2", " ", "cd", " ", "dcde", " ", "dsde", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "-", 
    RowBox[{"cd", " ", "d2c", " ", "sd", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["dcde", "2"], " ", "sd", " ", 
     SuperscriptBox[
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}]}], 
   SuperscriptBox["cd", "3"]]}]], "Output",
 CellChangeTimes->{{3.7396187770154667`*^9, 3.739618864004635*^9}, 
   3.739618913158354*^9, 3.7458372700749083`*^9}]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.739618621499701*^9, 3.739618622039585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"2", "\[HBar]", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["cd", "2"], " ", "sd", " ", 
         SuperscriptBox["tau", "2"]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["\[HBar]", "2"]}]]}], "+", 
      RowBox[{
       SuperscriptBox["cd", "2"], " ", "d2s", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "-", 
      RowBox[{"2", " ", "cd", " ", "dcde", " ", "dsde", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "-", 
      RowBox[{"cd", " ", "d2c", " ", "sd", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["dcde", "2"], " ", "sd", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "2"]}]}], 
     SuperscriptBox["cd", "3"]]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cd", "\[Rule]", "1"}], ",", 
     RowBox[{"sd", "\[Rule]", "s"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Delta]", "[", "EE", "]"}], "]"}], "\[Rule]", 
      RowBox[{"Cos", "[", "\[Delta]", "]"}]}], ",", 
     RowBox[{"dcde", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.740013960102798*^9, 3.7400139640865498`*^9}, {
  3.740014004513727*^9, 3.7400140131116447`*^9}, {3.74001406371489*^9, 
  3.740014076505711*^9}, {3.7401385635980473`*^9, 3.740138577850305*^9}, {
  3.740139079569517*^9, 3.7401390822233152`*^9}, {3.745837289062683*^9, 
  3.7458373223166237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"s", " ", 
     SuperscriptBox["tau", "2"]}], "\[HBar]"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"d2s", "-", 
     RowBox[{"d2c", " ", "s"}]}], ")"}], " ", "\[HBar]", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Delta]", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.740013965348283*^9, 3.740014014434244*^9, 3.740014081294578*^9, {
   3.740138568845049*^9, 3.740138578343706*^9}, 3.740139084728578*^9, {
   3.745837289787472*^9, 3.745837322780827*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]", "''"}], "[", "EE", "]"}], "/.", "%"}], "]"}]], "Input",\

 CellChangeTimes->{{3.739546388815624*^9, 3.7395464093802853`*^9}, {
  3.739581579565275*^9, 3.739581581026306*^9}}],

Cell["\<\
        (cd**2*d2s*Cos(\[Delta](EE))**2 - 2*cd*dcde*dsde*Cos(\[Delta](EE))**2 \
- 
     -    cd*d2c*sd*Cos(\[Delta](EE))**2 + 2*dcde**2*sd*Cos(\[Delta](EE))**2 - 
     -    (cd**3*tau**2*Tan(\[Delta](EE)))/2.)/cd**3\
\>", "Output",
 CellChangeTimes->{
  3.739546409798071*^9, 3.739546529603903*^9, 3.739546570103023*^9, 
   3.739546608856298*^9, 3.739575800277608*^9, {3.739581573721036*^9, 
   3.73958158420508*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"ArcTan", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.739624448543619*^9, 3.739624453662279*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "+", 
   SuperscriptBox["x", "2"]}]]], "Output",
 CellChangeTimes->{3.7396244541319437`*^9}]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.739546058621237*^9, 3.73954606074133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Together", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "e"}], "]"}], 
          ",", "e"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "''"}], "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"L", "(", 
               RowBox[{"L", "+", "1"}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", 
             "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
       "e"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        FractionBox["twomu", 
         RowBox[{"2", " ", "ek"}]]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["twomu", "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["ek", "3"]}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'''"}], "[", "e", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{"3", 
          SuperscriptBox["twomu", "3"]}], 
         RowBox[{"8", 
          SuperscriptBox["ek", "5"]}]]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rj"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "'"}], "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "fp"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "''"}], "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "fpp"}]}], "}"}]}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.7396296541383867`*^9, 3.739629707849614*^9}, {
   3.739629833588971*^9, 3.7396298843204727`*^9}, 3.739636123605668*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "ek", " ", "fp", " ", "r"}], "-", 
      RowBox[{"ek", " ", "fp", " ", "L", " ", "r"}], "-", 
      RowBox[{"ek", " ", "fp", " ", 
       SuperscriptBox["L", "2"], " ", "r"}], "+", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "fpp", " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["ek", "3"], " ", "fp", " ", 
       SuperscriptBox["r", "3"]}], "+", 
      RowBox[{"4", " ", "L", " ", "rj"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["L", "2"], " ", "rj"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["ek", "2"], " ", 
       SuperscriptBox["r", "2"], " ", "rj"}]}], ")"}], " ", 
    SuperscriptBox["twomu", "3"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ek", "6"]}]]}]], "Output",
 CellChangeTimes->{3.739629696475293*^9, 3.739629878902491*^9, 
  3.7396358948613586`*^9, 3.739636124254799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{3.739629666712371*^9}],

Cell["\<\
        -((-3*ek*fp*r - ek*fp*L*r - ek*fp*L**2*r + ek**2*fpp*r**2 + 
     -       ek**3*fp*r**3 + 4*L*rj + 4*L**2*rj - 2*ek**2*r**2*rj)*twomu**3)/
     -  (8.*ek**6)\
\>", "Output",
 CellChangeTimes->{3.7396358964967613`*^9, 3.7396361270227118`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Together", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], ",", "r"}], 
              "]"}], ",", "e"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "''"}], "[", 
              RowBox[{
               RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"L", "(", 
                  RowBox[{"L", "+", "1"}], ")"}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", 
                "1"}], ")"}], 
              RowBox[{"f", "[", 
               RowBox[{
                RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
          "e"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"f", "''"}], "[", 
           RowBox[{
            RowBox[{"k", "[", "e", "]"}], "r"}], "]"}], "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"L", "(", 
               RowBox[{"L", "+", "1"}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "-", 
             "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
       "e"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        FractionBox["twomu", 
         RowBox[{"2", " ", "ek"}]]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["twomu", "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["ek", "3"]}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'''"}], "[", "e", "]"}], "\[Rule]", 
        FractionBox[
         RowBox[{"3", 
          SuperscriptBox["twomu", "3"]}], 
         RowBox[{"8", 
          SuperscriptBox["ek", "5"]}]]}]}], "}"}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rj"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "'"}], "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "fp"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "''"}], "[", 
       RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "fpp"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7396354689832373`*^9, 3.739635548728588*^9}, {
  3.739636001985734*^9, 3.739636024752528*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ek", " ", "fp", " ", 
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"4", " ", "L", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "L"}], ")"}]}]}], ")"}], " ", "r"}], "-", 
     RowBox[{
      SuperscriptBox["ek", "4"], " ", "fpp", " ", 
      SuperscriptBox["r", "4"]}], "+", 
     RowBox[{"4", " ", "L", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "L"}], ")"}], " ", "rj"}], "+", 
     RowBox[{
      SuperscriptBox["ek", "2"], " ", 
      SuperscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"fpp", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "L", "+", 
           SuperscriptBox["L", "2"]}], ")"}]}], "+", 
        RowBox[{"2", " ", "rj"}]}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox["twomu", "3"]}], 
  RowBox[{"8", " ", 
   SuperscriptBox["ek", "6"], " ", "r"}]]], "Output",
 CellChangeTimes->{{3.739635520604355*^9, 3.7396355492671432`*^9}, 
   3.739635897970916*^9, {3.739636014820588*^9, 3.739636029719743*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{3.7396359008208*^9}],

Cell["\<\
        ((ek*fp*(3 - 4*L*(1 + L))*r - ek**4*fpp*r**4 + 4*L*(1 + L)*rj + 
     -      ek**2*r**2*(fpp*(-1 + L + L**2) + 2*rj))*twomu**3)/(8.*ek**6*r)\
\>", "Output",
 CellChangeTimes->{3.739635901247384*^9, 3.73963603537108*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"g", "[", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], ",", "r"}], 
              "]"}], ",", "e"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"g", "''"}], "[", 
              RowBox[{"r", " ", 
               RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"L", "(", 
                  RowBox[{"L", "+", "1"}], ")"}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", 
                "1"}], ")"}], 
              RowBox[{"g", "[", 
               RowBox[{
                RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
          "e"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "''"}], "[", 
           RowBox[{"r", " ", 
            RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"L", "(", 
               RowBox[{"L", "+", "1"}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", 
             "1"}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
       "e"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox["twomu", 
          RowBox[{"2", " ", "ek"}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["twomu", "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["ek", "3"]}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["twomu", "3"]}], 
          RowBox[{"8", " ", 
           SuperscriptBox["ek", "5"]}]]}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rk"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"r", " ", 
         RowBox[{"k", "[", "e", "]"}]}], "]"}], "\[Rule]", "gp"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "gp"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "''"}], "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "gpp"}]}], "}"}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{
  3.7396356303300953`*^9, {3.739635723100481*^9, 3.73963575883921*^9}, {
   3.7396359702564793`*^9, 3.739635975503687*^9}, {3.739636054349493*^9, 
   3.739636064829709*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "ek", " ", "gp", " ", "r"}], "-", 
      RowBox[{"4", " ", "ek", " ", "gp", " ", "L", " ", "r"}], "-", 
      RowBox[{"4", " ", "ek", " ", "gp", " ", 
       SuperscriptBox["L", "2"], " ", "r"}], "-", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "gpp", " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "gpp", " ", "L", " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "gpp", " ", 
       SuperscriptBox["L", "2"], " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["ek", "4"], " ", "gpp", " ", 
       SuperscriptBox["r", "4"]}], "+", 
      RowBox[{"4", " ", "L", " ", "rk"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["L", "2"], " ", "rk"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["ek", "2"], " ", 
       SuperscriptBox["r", "2"], " ", "rk"}]}], ")"}], " ", 
    SuperscriptBox["twomu", "3"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ek", "6"], " ", "r"}]]}]], "Output",
 CellChangeTimes->{
  3.739635763080173*^9, 3.739635902777417*^9, 3.739635978130845*^9, {
   3.739636055378828*^9, 3.7396360654639177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{3.7396359061803226`*^9}],

Cell["\<\
        -((3*ek*gp*r - 4*ek*gp*L*r - 4*ek*gp*L**2*r - ek**2*gpp*r**2 + 
     -       ek**2*gpp*L*r**2 + ek**2*gpp*L**2*r**2 + ek**4*gpp*r**4 + 
     -       4*L*rk + 4*L**2*rk - 2*ek**2*r**2*rk)*twomu**3)/(8.*ek**6*r)\
\>", "Output",
 CellChangeTimes->{3.7396359070328703`*^9, 3.73963598081814*^9, 
  3.7396360724905787`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{
              RowBox[{"k", "[", "e", "]"}], " ", "r"}], "]"}], ",", "e"}], 
           "]"}], ",", "e"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "''"}], "[", 
           RowBox[{"r", " ", 
            RowBox[{"k", "[", "e", "]"}]}], "]"}], "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"L", "(", 
               RowBox[{"L", "+", "1"}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"k", "[", "e", "]"}], "r"}], ")"}], "2"]], "+", 
             "1"}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"k", "[", "e", "]"}], "r"}], "]"}]}]}], "}"}]}], ",", 
       "e"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "[", "e", "]"}], "\[Rule]", "ek"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox["twomu", 
          RowBox[{"2", " ", "ek"}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["twomu", "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["ek", "3"]}]]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "'''"}], "[", "e", "]"}], "->", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox["twomu", "3"]}], 
          RowBox[{"8", " ", 
           SuperscriptBox["ek", "5"]}]]}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "rk"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"r", " ", 
         RowBox[{"k", "[", "e", "]"}]}], "]"}], "\[Rule]", "gp"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "gp"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "''"}], "[", 
        RowBox[{"ek", " ", "r"}], "]"}], "\[Rule]", "gpp"}]}], "}"}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.7396358139323463`*^9, 3.739635849479368*^9}, {
  3.739635940096715*^9, 3.739635951798394*^9}, {3.739636078317285*^9, 
  3.739636082520842*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "ek", " ", "gp", " ", "r"}], "+", 
      RowBox[{"ek", " ", "gp", " ", "L", " ", "r"}], "+", 
      RowBox[{"ek", " ", "gp", " ", 
       SuperscriptBox["L", "2"], " ", "r"}], "-", 
      RowBox[{
       SuperscriptBox["ek", "2"], " ", "gpp", " ", 
       SuperscriptBox["r", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["ek", "3"], " ", "gp", " ", 
       SuperscriptBox["r", "3"]}], "-", 
      RowBox[{"4", " ", "L", " ", "rk"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["L", "2"], " ", "rk"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["ek", "2"], " ", 
       SuperscriptBox["r", "2"], " ", "rk"}]}], ")"}], " ", 
    SuperscriptBox["twomu", "3"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["ek", "6"]}]]}]], "Output",
 CellChangeTimes->{3.739635850991366*^9, 3.739635908993082*^9, 
  3.73963595932156*^9, 3.739636084037488*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FortranForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{3.739635911642787*^9}],

Cell["\<\
        -((3*ek*gp*r + ek*gp*L*r + ek*gp*L**2*r - ek**2*gpp*r**2 + 
     -       ek**3*gp*r**3 - 4*L*rk - 4*L**2*rk - 2*ek**2*r**2*rk)*twomu**3)/
     -  (8.*ek**6)\
\>", "Output",
 CellChangeTimes->{3.73963591216715*^9, 3.739635962761867*^9, 
  3.739636088207157*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Alternative schemes for solving the scattering problem?", "Subsection",
 CellChangeTimes->{{3.738884975914859*^9, 3.738884995052431*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"A", " ", "x"}], " ", "=", " ", 
   RowBox[{"b", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "11"],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{"1", "N"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           RowBox[{"-", 
            SubscriptBox["g", "1"]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "11"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{"1", "N"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["g", "1"]}], 
             RowBox[{"\[PartialD]", "r"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0", "0", "0"},
         {
          StyleBox["\[VerticalEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[DescendingEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[VerticalEllipsis]",
           FontColor->RGBColor[1, 0, 0]], "0", "\[DescendingEllipsis]", "0", 
          "0", "0"},
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{
             RowBox[{"N", "-", "1"}], ",", "1"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", 
            RowBox[{
             RowBox[{"N", "-", "1"}], ",", "N"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", 
          StyleBox[
           RowBox[{"-", 
            SubscriptBox["g", 
             RowBox[{"N", "-", "1"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0"},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{
               RowBox[{"N", "-", "1"}], ",", "1"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", 
              RowBox[{
               RowBox[{"N", "-", "1"}], ",", "N"}]]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", 
          StyleBox[
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["g", 
               RowBox[{"N", "-", "1"}]]}], 
             RowBox[{"\[PartialD]", "r"}]]}],
           FontColor->RGBColor[0, 0, 1]], "0", "0"},
         {
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "N1"],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           SubscriptBox["\[CapitalPhi]", "NN"],
           FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
          RowBox[{"-", 
           SubscriptBox["f", "o"]}], 
          SubscriptBox["g", "o"]},
         {
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "N1"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox["\[CenterEllipsis]",
           FontColor->RGBColor[1, 0, 0]], 
          StyleBox[
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalPhi]", "NN"]}], 
            RowBox[{"\[PartialD]", "r"}]],
           FontColor->RGBColor[1, 0, 0]], "0", "0", "0", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["f", "o"]}], 
            RowBox[{"\[PartialD]", "r"}]]}], 
          FractionBox[
           RowBox[{"\[PartialD]", 
            SubscriptBox["g", "o"]}], 
           RowBox[{"\[PartialD]", "r"}]]},
         {"0", "0", "0", "0", "0", "0", "1", "0"}
        }], ")"}], 
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["b", "1"]},
         {"\[VerticalEllipsis]"},
         {
          SubscriptBox["b", "N"]},
         {
          SubscriptBox["a", "1"]},
         {"\[VerticalEllipsis]"},
         {
          SubscriptBox["a", 
           RowBox[{"N", "-", "1"}]]},
         {"c"},
         {"s"}
        }], ")"}]}], "=", 
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"\[VerticalEllipsis]"},
        {"0"},
        {"0"},
        {"0"},
        {"0"},
        {"1"}
       }], ")"}]}]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.738884998311981*^9}],

Cell["\<\
Let\[CloseCurlyQuote]s see if we can reformulate this into a log-derivative \
method. We have a set of equations\
\>", "Text",
 CellChangeTimes->{{3.738885003782609*^9, 3.738885035486363*^9}, {
  3.738885074309659*^9, 3.738885078957552*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    OverscriptBox[
     UnderscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}]], "N"], 
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], 
     SubscriptBox["\[Phi]", "\[Alpha]"], 
     SubscriptBox["b", "\[Alpha]"]}]}], "=", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{
           SubscriptBox["a", "i"], 
           SubscriptBox["g", "i"]}], 
          RowBox[{"i", "\[Element]", "closed"}]},
         {
          RowBox[{
           RowBox[{"c", " ", 
            SubscriptBox["f", "o"]}], "-", 
           RowBox[{"s", " ", 
            SubscriptBox["g", "o"]}]}], "open"}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False], " "}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738885093225967*^9, 3.738885279570004*^9}}],

Cell["\<\
And a corresponding expression for the radial derivatives.  What does the \
log-derivative of each side look like?\
\>", "Text",
 CellChangeTimes->{{3.738885292259288*^9, 3.738885319960363*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     OverscriptBox[
      UnderscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}]], "N"], 
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        SubscriptBox["\[Phi]", "\[Alpha]"]}], 
       RowBox[{"\[PartialD]", "r"}]], 
      SubscriptBox["b", "\[Alpha]"]}]}], 
    RowBox[{
     OverscriptBox[
      UnderscriptBox["\[Sum]", 
       RowBox[{"\[Alpha]", "=", "1"}]], "N"], 
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      SubscriptBox["\[Phi]", "\[Alpha]"], 
      SubscriptBox["b", "\[Alpha]"]}]}]], "=", 
   RowBox[{"(", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            FractionBox["1", "g"], 
            FractionBox[
             RowBox[{"\[PartialD]", 
              SubscriptBox["g", "i"]}], 
             RowBox[{"\[PartialD]", "r"}]]}], 
           RowBox[{"i", "\[Element]", "closed"}]},
          {
           FractionBox[
            RowBox[{
             RowBox[{"c", " ", 
              FractionBox[
               RowBox[{"\[PartialD]", 
                SubscriptBox["f", "o"]}], 
               RowBox[{"\[PartialD]", "r"}]]}], "-", 
             RowBox[{"s", " ", 
              FractionBox[
               RowBox[{"\[PartialD]", 
                SubscriptBox["g", "o"]}], 
               RowBox[{"\[PartialD]", "r"}]]}]}], 
            RowBox[{
             RowBox[{"c", " ", "f"}], "-", 
             RowBox[{"s", " ", "g"}]}]], "open"}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False], " ", ")"}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7388869988897867`*^9, 3.738887028961259*^9}}],

Cell["or...", "Text",
 CellChangeTimes->{{3.7388870130133333`*^9, 3.738887014078264*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    OverscriptBox[
     UnderscriptBox["\[Sum]", 
      RowBox[{"\[Alpha]", "=", "1"}]], "N"], 
    RowBox[{
     SubscriptBox["U", "i\[Alpha]"], 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Phi]", "\[Alpha]"]}], 
      RowBox[{"\[PartialD]", "r"}]], 
     SubscriptBox["b", "\[Alpha]"]}]}], "=", 
   RowBox[{
    RowBox[{"(", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             FractionBox["1", 
              SubscriptBox["g", "i"]], 
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["g", "i"]}], 
              RowBox[{"\[PartialD]", "r"}]]}], 
            RowBox[{"i", "\[Element]", "closed"}]},
           {
            FractionBox[
             RowBox[{" ", 
              RowBox[{
               FractionBox[
                RowBox[{"\[PartialD]", 
                 SubscriptBox["f", "o"]}], 
                RowBox[{"\[PartialD]", "r"}]], "-", 
               RowBox[{"tan", " ", "\[Delta]", 
                FractionBox[
                 RowBox[{"\[PartialD]", 
                  SubscriptBox["g", "o"]}], 
                 RowBox[{"\[PartialD]", "r"}]]}]}]}], 
             RowBox[{"f", "-", " ", 
              RowBox[{"tan", " ", "\[Delta]", " ", "g"}]}]], "open"}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False], " ", ")"}], 
    RowBox[{
     OverscriptBox[
      UnderscriptBox["\[Sum]", 
       RowBox[{"\[Alpha]", "=", "1"}]], "N"], 
     RowBox[{
      SubscriptBox["U", "i\[Alpha]"], 
      SubscriptBox["\[Phi]", "\[Alpha]"], 
      SubscriptBox["b", "\[Alpha]"]}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738885323940666*^9, 3.738885460145948*^9}, {
   3.738886970978195*^9, 3.73888697875206*^9}, 3.738887034216762*^9, {
   3.73904894751543*^9, 3.739048947881785*^9}}],

Cell[TextData[{
 "Again, we let ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " be a diagonal matrix "
}], "Text",
 CellChangeTimes->{{3.738887121711385*^9, 3.738887141047389*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["G", 
    RowBox[{"i", " ", "i"}]], "=", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{
           FractionBox["1", 
            SubscriptBox["g", "i"]], 
           FractionBox[
            RowBox[{"\[PartialD]", 
             SubscriptBox["g", "i"]}], 
            RowBox[{"\[PartialD]", "r"}]]}], 
          RowBox[{"i", "\[Element]", "closed"}]},
         {
          FractionBox[
           RowBox[{" ", 
            RowBox[{
             FractionBox[
              RowBox[{"\[PartialD]", 
               SubscriptBox["f", "o"]}], 
              RowBox[{"\[PartialD]", "r"}]], "-", 
             RowBox[{"tan", " ", "\[Delta]", 
              FractionBox[
               RowBox[{"\[PartialD]", 
                SubscriptBox["g", "o"]}], 
               RowBox[{"\[PartialD]", "r"}]]}]}]}], 
           RowBox[{"f", "-", " ", 
            RowBox[{"tan", " ", "\[Delta]", " ", "g"}]}]], "open"}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738887143816757*^9, 3.738887157096881*^9}, {
  3.739048767296527*^9, 3.7390487676913548`*^9}}],

Cell[TextData[{
 "But the problem is that the open-channel sector now contains an unknown ",
 Cell[BoxData[
  FormBox[
   RowBox[{"tan", " ", "\[Delta]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.738887161092198*^9, 3.7388871944851294`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"\[PartialD]", "\[CapitalPhi]"}], 
      RowBox[{"\[PartialD]", "r"}]], ")"}], 
    RowBox[{"i", ",", "\[Alpha]"}]], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], 
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[Phi]", "\[Alpha]"]}], 
     RowBox[{"\[PartialD]", "r"}]]}]}], TraditionalForm]], "EquationNumbered",\

 CellChangeTimes->{{3.738887205022971*^9, 3.738887251647009*^9}, 
   3.7390489177650023`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox[
    RowBox[{"(", "\[CapitalPhi]", ")"}], "i\[Alpha]"], "=", 
   RowBox[{
    SubscriptBox["U", "i\[Alpha]"], 
    SubscriptBox["\[Phi]", "\[Alpha]"]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.738885593228204*^9, 3.738885629203932*^9}, {
  3.738886656001575*^9, 3.738886661160172*^9}, {3.738886974744588*^9, 
  3.738886996848577*^9}, {3.7388872582291727`*^9, 3.7388872688102217`*^9}, {
  3.739048712135957*^9, 3.739048720501375*^9}}],

Cell["In matrix form,", "Text",
 CellChangeTimes->{{3.738887272325156*^9, 3.7388872748659477`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[PartialD]", "\[CapitalPhi]"}], 
       RowBox[{"\[PartialD]", "r"}]], "-", 
      RowBox[{"G", " ", "\[CapitalPhi]"}]}], ")"}], "b"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.73888727915864*^9, 3.738887305250894*^9}}],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is the vector of coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "\[Alpha]"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  For the scattering problem, the energy is known, but ",
 Cell[BoxData[
  FormBox[
   RowBox[{"tan", " ", "\[Delta]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is unknown, and appears in ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".  It could be that for a given energy, there is a unique ",
 Cell[BoxData[
  FormBox[
   RowBox[{"tan", " ", "\[Delta]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " that gives "
}], "Text",
 CellChangeTimes->{{3.738887311596492*^9, 3.738887331161566*^9}, {
  3.739049039447628*^9, 3.7390491081588078`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"det", "|", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[PartialD]", "\[CapitalPhi]"}], 
       RowBox[{"\[PartialD]", "r"}]], "-", 
      RowBox[{"G", " ", "\[CapitalPhi]"}]}], ")"}], "|"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7390491131352453`*^9, 3.739049123462347*^9}}],

Cell["Start with the SE", "Text",
 CellChangeTimes->{{3.7390570595359898`*^9, 3.739057061728236*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox["V",
       FontWeight->"Bold"]}], ")"}], "\[Psi]"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7034183215284758`*^9, 3.7034183852038727`*^9}}],

Cell["by an orthogonal transformation", "Text",
 CellChangeTimes->{{3.70341824316885*^9, 3.7034182549476833`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox["\[CapitalLambda]",
    FontWeight->"Bold"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       StyleBox["U",
        FontWeight->"Bold"], "\[Transpose]"}], 
      StyleBox["V",
       FontWeight->"Bold"], " ", 
      StyleBox["U",
       FontWeight->"Bold"]}], 
     StyleBox[" ",
      FontWeight->"Bold"], "\[Implies]", " ", 
     StyleBox["V",
      FontWeight->"Bold"]}], "=", 
    RowBox[{
     StyleBox["U",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     StyleBox["\[CapitalLambda]",
      FontWeight->"Bold"], 
     StyleBox[" ",
      FontWeight->"Bold"], 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold"], "\[Transpose]"}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.703418259539921*^9, 3.7034182750986853`*^9}, {
  3.703418476159919*^9, 3.703418516984694*^9}}],

Cell["Then", "Text",
 CellChangeTimes->{{3.7034184659939203`*^9, 3.7034184663301764`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox[
       RowBox[{"U", " ", "\[CapitalLambda]", " ", 
        RowBox[{"U", "\[Transpose]"}]}],
       FontWeight->"Bold"]}], ")"}], "\[Psi]"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{3.703418463420972*^9, 3.7034185295732403`*^9}],

Cell[TextData[{
 "We can hit this from the left with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "\[Transpose]"}], TraditionalForm]]],
 " and thus since it clearly commutes with ",
 Cell[BoxData[
  FormBox[
   StyleBox["1",
    FontWeight->"Bold"], TraditionalForm]]],
 " we write (using ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["U", "T"], "U"}], "=", "1"}], TraditionalForm]]],
 "):"
}], "Text",
 CellChangeTimes->{{3.7034185486974373`*^9, 3.703418638547022*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox["\[CapitalLambda]",
       FontWeight->"Bold"]}], ")"}], 
    StyleBox[" ",
     FontWeight->"Bold"], 
    StyleBox[
     RowBox[{"U", "\[Transpose]"}],
     FontWeight->"Bold"], "\[Psi]"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7034186083732567`*^9, 3.703418629451748*^9}, {
  3.703418728057949*^9, 3.703418728076294*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox["\[CapitalLambda]",
       FontWeight->"Bold"]}], ")"}], 
    StyleBox[" ",
     FontWeight->"Bold"], "\[Phi]"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7034186083732567`*^9, 3.703418629451748*^9}, {
  3.703418728057949*^9, 3.703418733729748*^9}}],

Cell["where we define ", "Text",
 CellChangeTimes->{{3.703418646457634*^9, 3.703418649363618*^9}, {
  3.7034187386728687`*^9, 3.70341873915466*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Phi]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["U", "T"], "\[Psi]"}], " ", "\[Implies]", "\[Psi]"}], 
    "=", 
    RowBox[{"U", " ", "\[Phi]"}]}]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7034186523716717`*^9, 3.703418661771071*^9}, {
  3.7034187093162193`*^9, 3.703418717896955*^9}}],

Cell[TextData[{
 "But ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Psi]", "=", 
    RowBox[{"U", " ", "\[Phi]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is not the only solution in the interior region.  Note that any two \
diagonal matrices consisting of constant elements will commute.  Proof: let \
",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],
  FormatType->"TraditionalForm",
  FontWeight->"Bold"],
 " and ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],
  FormatType->"TraditionalForm",
  FontWeight->"Bold"],
 " be diagonal constant matrices with elements ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "i"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", then:"
}], "Text",
 CellChangeTimes->{{3.7390571086583443`*^9, 3.7390571545710287`*^9}, {
  3.73905718947502*^9, 3.739057221603409*^9}, {3.739057293847681*^9, 
  3.7390573015334806`*^9}, {3.739057473744491*^9, 3.739057544376528*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"A", " ", "B"}], " ", "-", " ", 
    RowBox[{"B", " ", "A"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      UnderscriptBox["\[Sum]", "k"], 
      RowBox[{
       SubscriptBox["A", "ik"], 
       SubscriptBox["B", "kj"]}]}], "-", 
     RowBox[{
      UnderscriptBox["\[Sum]", "k"], 
      RowBox[{
       SubscriptBox["B", "ik"], 
       SubscriptBox["A", "kj"]}]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       UnderscriptBox["\[Sum]", "k"], 
       RowBox[{
        SubscriptBox["\[Delta]", "ik"], 
        SubscriptBox["a", "i"], 
        SubscriptBox["\[Delta]", "kj"], 
        SubscriptBox["b", "j"]}]}], "-", 
      RowBox[{
       UnderscriptBox["\[Sum]", "k"], 
       RowBox[{
        SubscriptBox["\[Delta]", "ik"], 
        SubscriptBox["b", "i"], 
        SubscriptBox["\[Delta]", "kj"], 
        SubscriptBox["a", "j"]}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["a", "i"], 
        SubscriptBox["\[Delta]", "ij"], 
        SubscriptBox["b", "j"]}], "-", 
       RowBox[{
        SubscriptBox["b", "i"], 
        SubscriptBox["\[Delta]", "ij"], 
        SubscriptBox["a", "j"]}]}], "=", "0"}]}]}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7390571086583443`*^9, 3.7390571545710287`*^9}, {
  3.73905718947502*^9, 3.739057221603409*^9}, {3.739057293847681*^9, 
  3.7390573015334806`*^9}, {3.739057473744491*^9, 3.7390574971448193`*^9}, {
  3.739057549751925*^9, 3.7390576860871553`*^9}, {3.7390577347713413`*^9, 
  3.739057758274048*^9}}],

Cell[TextData[{
 "Indeed, one can left-multiply by any diagonal matrix with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SuperscriptBox["B", 
       RowBox[{"-", "1"}]], ")"}], "\[Alpha]\[Beta]"], "=", 
    RowBox[{
     SubscriptBox["\[Delta]", "\[Alpha]\[Beta]"], 
     SubsuperscriptBox["b", "\[Alpha]", 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", where the ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["b", "\[Alpha]", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are arbitrary constants"
}], "Text",
 CellChangeTimes->{{3.7390571086583443`*^9, 3.7390571545710287`*^9}, {
  3.73905718947502*^9, 3.739057221603409*^9}, {3.739057293847681*^9, 
  3.7390573015334806`*^9}, {3.739057789235091*^9, 3.739057789698142*^9}, {
  3.739057855091714*^9, 3.739057862360257*^9}, {3.739057904913361*^9, 
  3.739057905568802*^9}, {3.739058083956647*^9, 3.7390580862390223`*^9}, {
  3.739064509054734*^9, 3.739064509351121*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      StyleBox["B",
       FontWeight->"Bold"], 
      RowBox[{"-", "1"}]], "(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox["\[CapitalLambda]",
       FontWeight->"Bold"]}], ")"}], 
    StyleBox[" ",
     FontWeight->"Bold"], 
    StyleBox[
     RowBox[{"U", "\[Transpose]"}],
     FontWeight->"Bold"], "\[Psi]"}], "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739057312408231*^9, 3.7390573163009567`*^9}, {
   3.739057794907651*^9, 3.739057797372406*^9}, {3.739057910980968*^9, 
   3.73905791157167*^9}, 3.739057972968968*^9}],

Cell[TextData[{
 "And since ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["B",
     FontWeight->"Bold"], 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " commutes with ",
 Cell[BoxData[
  FormBox[
   StyleBox["1",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   StyleBox["\[CapitalLambda]",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ","
}], "Text",
 CellChangeTimes->{{3.73905780944864*^9, 3.739057830938788*^9}, {
  3.7390579199778233`*^9, 3.73905792063682*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["H", "0"], "-", "E"}], ")"}], 
       StyleBox["1",
        FontWeight->"Bold"]}], "+", 
      StyleBox["\[CapitalLambda]",
       FontWeight->"Bold"]}], ")"}], 
    StyleBox[" ",
     FontWeight->"Bold"], 
    SuperscriptBox[
     StyleBox["B",
      FontWeight->"Bold"], 
     RowBox[{"-", "1"}]], 
    StyleBox[
     RowBox[{"U", "\[Transpose]"}],
     FontWeight->"Bold"], "\[Psi]"}], " ", "=", "0"}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739057803580653*^9, 3.739057807884316*^9}, {
   3.7390579151729116`*^9, 3.739057915755745*^9}, 3.739057990601219*^9}],

Cell["Then define", "Text",
 CellChangeTimes->{{3.739057897567827*^9, 3.739057899379588*^9}, {
  3.7390580005745564`*^9, 3.739058001725499*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Phi]", "=", 
   RowBox[{
    SuperscriptBox[
     StyleBox["B",
      FontWeight->"Bold"], 
     RowBox[{"-", "1"}]], 
    StyleBox[
     RowBox[{"U", "\[Transpose]"}],
     FontWeight->"Bold"], "\[Psi]", " "}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739057938646104*^9, 3.739057954646803*^9}, {
  3.73905799770399*^9, 3.7390580108568783`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"\[Psi]", "=", 
   RowBox[{
    StyleBox["U",
     FontWeight->"Bold"], 
    StyleBox[" ",
     FontWeight->"Bold"], 
    StyleBox["B",
     FontWeight->"Bold"], 
    StyleBox[" ",
     FontWeight->"Bold"], "\[Phi]", " "}]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.7390580222571173`*^9, 3.739058052744061*^9}}],

Cell[TextData[{
 "where the diagonal elements of ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "\[Alpha]"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.739058094941429*^9, 3.739058110678027*^9}}],

Cell[TextData[{
 "The constants ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "\[Alpha]"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " must be chosen to match smoothly onto exterior solutions.  The matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["B",
     FontWeight->"Bold"], 
    StyleBox["=",
     FontWeight->"Plain"], 
    RowBox[{
     StyleBox["B",
      FontWeight->"Bold"], 
     StyleBox["(",
      FontWeight->"Plain"], 
     StyleBox["E",
      FontWeight->"Plain"], 
     StyleBox[")",
      FontWeight->"Plain"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is a function of the energy, but ",
 Cell[BoxData[
  FormBox[
   StyleBox["U",
    FontWeight->"Bold"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is independent of the energy."
}], "Text",
 CellChangeTimes->{{3.739058161416998*^9, 3.739058234646007*^9}, {
  3.739063890667611*^9, 3.7390639646491413`*^9}}],

Cell["In the exterior region, the channel wavefunctions are", "Text",
 CellChangeTimes->{{3.739064008008601*^9, 3.739064025427576*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[Psi]", "i"], "\[Rule]", 
   TagBox[GridBox[{
      {"\[Piecewise]", GridBox[{
         {
          RowBox[{
           SubscriptBox["a", "i"], 
           SubscriptBox["g", "i"]}], 
          RowBox[{"i", "\[Element]", "closed"}]},
         {
          RowBox[{
           RowBox[{"c", " ", 
            SubscriptBox["f", "o"]}], "-", 
           RowBox[{"s", " ", 
            SubscriptBox["g", "o"]}]}], "open"}
        },
        AllowedDimensions->{2, Automatic},
        Editable->True,
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.84]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}},
        Selectable->True]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.35]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    "Piecewise",
    DeleteWithContents->True,
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739064027885621*^9, 3.73906404523085*^9}, {
  3.739064631209507*^9, 3.739064635841505*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[Psi]", "i"], "=", 
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox["B",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], "\[Phi]"}], " ", ")"}], "i"]}], 
  TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.739063980157144*^9, 3.739063985881423*^9}, {
  3.73906429191831*^9, 3.739064296724777*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1436, 793},
WindowMargins->{{Automatic, 0}, {2, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"NPMStyleSheet1.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 118, 1, 96, "Title"],
Cell[701, 25, 86, 1, 61, "Author"],
Cell[CellGroupData[{
Cell[812, 30, 133, 1, 39, "Section"],
Cell[948, 33, 632, 17, 42, "Text"],
Cell[1583, 52, 122, 1, 31, "Text"],
Cell[1708, 55, 192, 5, 40, "EquationNumbered"],
Cell[1903, 62, 123, 1, 31, "Text"],
Cell[2029, 65, 423, 13, 62, "EquationNumbered"],
Cell[2455, 80, 903, 30, 42, "Text"],
Cell[3361, 112, 5474, 162, 262, "EquationNumbered"],
Cell[8838, 276, 132, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[8995, 281, 334, 8, 63, "Subsection"],
Cell[9332, 291, 91, 1, 31, "Text"],
Cell[9426, 294, 642, 20, 66, "EquationNumbered"],
Cell[10071, 316, 540, 19, 43, "Text"],
Cell[10614, 337, 2207, 67, 67, "EquationNumbered"],
Cell[12824, 406, 737, 23, 67, "EquationNumbered"],
Cell[13564, 431, 532, 15, 43, "Text"],
Cell[14099, 448, 1847, 56, 67, "EquationNumbered"],
Cell[15949, 506, 780, 24, 67, "EquationNumbered"],
Cell[16732, 532, 127, 1, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16896, 538, 465, 13, 63, "Subsection"],
Cell[17364, 553, 113, 1, 31, "Text"],
Cell[17480, 556, 5500, 145, 108, "EquationNumbered"],
Cell[22983, 703, 344, 9, 31, "Text"],
Cell[23330, 714, 3305, 87, 108, "EquationNumbered"],
Cell[26638, 803, 4615, 120, 108, "EquationNumbered"],
Cell[31256, 925, 4590, 120, 108, "EquationNumbered"],
Cell[35849, 1047, 225, 4, 31, "Text"],
Cell[36077, 1053, 1063, 34, 71, "EquationNumbered"],
Cell[37143, 1089, 314, 9, 31, "Text"],
Cell[37460, 1100, 699, 22, 69, "EquationNumbered"],
Cell[38162, 1124, 89, 1, 31, "Text"],
Cell[38254, 1127, 567, 18, 69, "EquationNumbered"],
Cell[38824, 1147, 93, 1, 31, "Text"],
Cell[38920, 1150, 1083, 36, 68, "EquationNumbered"],
Cell[40006, 1188, 495, 17, 37, "Text"],
Cell[40504, 1207, 727, 23, 69, "EquationNumbered"],
Cell[41234, 1232, 730, 23, 71, "EquationNumbered"],
Cell[41967, 1257, 1219, 38, 68, "EquationNumbered"],
Cell[43189, 1297, 5110, 132, 112, "EquationNumbered"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48336, 1434, 292, 8, 64, "Subsection"],
Cell[48631, 1444, 501, 15, 45, "Text"],
Cell[49135, 1461, 2118, 64, 65, "EquationNumbered"],
Cell[51256, 1527, 708, 22, 65, "EquationNumbered"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52001, 1554, 570, 17, 63, "Subsection"],
Cell[52574, 1573, 419, 12, 43, "Text"],
Cell[52996, 1587, 1025, 32, 66, "EquationNumbered"],
Cell[54024, 1621, 597, 19, 66, "EquationNumbered"],
Cell[54624, 1642, 595, 19, 66, "EquationNumbered"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55256, 1666, 657, 22, 69, "Subsection"],
Cell[55916, 1690, 1680, 51, 70, "EquationNumbered"],
Cell[57599, 1743, 1255, 40, 72, "EquationNumbered"],
Cell[58857, 1785, 1286, 40, 67, "EquationNumbered"],
Cell[60146, 1827, 99, 1, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60282, 1833, 783, 25, 70, "Subsection"],
Cell[61068, 1860, 1845, 57, 70, "EquationNumbered"],
Cell[62916, 1919, 1307, 40, 72, "EquationNumbered"],
Cell[64226, 1961, 1328, 41, 66, "EquationNumbered"],
Cell[65557, 2004, 332, 10, 42, "Text"],
Cell[65892, 2016, 235, 4, 31, "Text"],
Cell[66130, 2022, 82, 1, 31, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66261, 2029, 165, 3, 71, "Section"],
Cell[66429, 2034, 124, 1, 31, "Text"],
Cell[66556, 2037, 399, 13, 62, "EquationNumbered"],
Cell[66958, 2052, 89, 1, 31, "Text"],
Cell[67050, 2055, 416, 13, 62, "EquationNumbered"],
Cell[67469, 2070, 1045, 34, 67, "EquationNumbered"],
Cell[68517, 2106, 870, 27, 67, "EquationNumbered"],
Cell[69390, 2135, 442, 13, 47, "Text"],
Cell[69835, 2150, 4370, 132, 262, "EquationNumbered"],
Cell[74208, 2284, 367, 11, 40, "EquationNumbered"],
Cell[CellGroupData[{
Cell[74600, 2299, 343, 9, 69, "Subsection"],
Cell[74946, 2310, 1245, 41, 68, "EquationNumbered"],
Cell[76194, 2353, 638, 22, 51, "Text"],
Cell[76835, 2377, 1039, 35, 70, "EquationNumbered"],
Cell[CellGroupData[{
Cell[77899, 2416, 2237, 68, 140, "Input"],
Cell[80139, 2486, 765, 20, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80941, 2511, 129, 2, 46, "Input"],
Cell[81073, 2515, 157, 3, 45, "Output"]
}, Open  ]],
Cell[81245, 2521, 731, 24, 43, "Text"],
Cell[CellGroupData[{
Cell[82001, 2549, 521, 16, 59, "Input"],
Cell[82525, 2567, 117, 3, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82679, 2575, 652, 20, 59, "Input"],
Cell[83334, 2597, 334, 8, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83705, 2610, 680, 21, 59, "Input"],
Cell[84388, 2633, 192, 6, 68, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84629, 2645, 370, 10, 70, "Subsection"],
Cell[85002, 2657, 118, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[85145, 2662, 1760, 58, 139, "Input"],
Cell[86908, 2722, 758, 24, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87703, 2751, 227, 4, 46, "Input"],
Cell[87933, 2757, 254, 6, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88236, 2769, 471, 14, 67, "Subsection"],
Cell[88710, 2785, 1226, 38, 67, "EquationNumbered"],
Cell[89939, 2825, 1237, 38, 67, "EquationNumbered"],
Cell[CellGroupData[{
Cell[91201, 2867, 3168, 92, 235, "Input"],
Cell[94372, 2961, 1031, 29, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95440, 2995, 145, 2, 46, "Input"],
Cell[95588, 2999, 909, 27, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96534, 3031, 141, 2, 46, "Input"],
Cell[96678, 3035, 273, 5, 70, "Output"]
}, Open  ]],
Cell[96966, 3043, 1160, 38, 103, "Input"],
Cell[CellGroupData[{
Cell[98151, 3085, 744, 23, 59, "Input"],
Cell[98898, 3110, 269, 8, 68, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99216, 3124, 500, 15, 67, "Subsection"],
Cell[99719, 3141, 212, 4, 46, "Input"],
Cell[CellGroupData[{
Cell[99956, 3149, 3987, 116, 245, "Input"],
Cell[103946, 3267, 1371, 32, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105354, 3304, 130, 2, 46, "Input"],
Cell[105487, 3308, 205, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105729, 3317, 2551, 83, 179, "Input"],
Cell[108283, 3402, 554, 18, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108874, 3425, 130, 2, 46, "Input"],
Cell[109007, 3429, 134, 3, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109190, 3438, 137, 1, 46, "Subsection"],
Cell[109330, 3441, 26, 0, 46, "Input"],
Cell[CellGroupData[{
Cell[109381, 3445, 2040, 65, 181, "Input"],
Cell[111424, 3512, 649, 18, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112110, 3535, 130, 2, 46, "Input"],
Cell[112243, 3539, 131, 3, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112411, 3547, 3087, 95, 220, "Input"],
Cell[115501, 3644, 799, 24, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116337, 3673, 132, 2, 46, "Input"],
Cell[116472, 3677, 195, 4, 70, "Output"]
}, Open  ]],
Cell[116682, 3684, 105, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[116812, 3689, 1988, 64, 140, "Input"],
Cell[118803, 3755, 516, 17, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119356, 3777, 132, 2, 46, "Input"],
Cell[119491, 3781, 130, 3, 45, "Output"]
}, Open  ]],
Cell[119636, 3787, 126, 2, 46, "Input"],
Cell[CellGroupData[{
Cell[119787, 3793, 2365, 72, 181, "Input"],
Cell[122155, 3867, 787, 24, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122979, 3896, 132, 2, 46, "Input"],
Cell[123114, 3900, 222, 5, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123373, 3910, 741, 21, 46, "Input"],
Cell[124117, 3933, 895, 27, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125049, 3965, 355, 10, 46, "Input"],
Cell[125407, 3977, 639, 18, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126083, 4000, 377, 11, 46, "Input"],
Cell[126463, 4013, 1052, 31, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127552, 4049, 1576, 43, 98, "Input"],
Cell[129131, 4094, 1245, 34, 81, "Output"]
}, Open  ]],
Cell[130391, 4131, 82, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[130498, 4136, 1781, 45, 134, "Input"],
Cell[132282, 4183, 553, 15, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132872, 4203, 265, 7, 46, "Input"],
Cell[133140, 4212, 427, 9, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133604, 4226, 177, 4, 46, "Input"],
Cell[133784, 4232, 140, 4, 63, "Output"]
}, Open  ]],
Cell[133939, 4239, 81, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[134045, 4244, 2438, 77, 172, "Input"],
Cell[136486, 4323, 1001, 27, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137524, 4355, 106, 2, 46, "Input"],
Cell[137633, 4359, 259, 5, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137929, 4369, 3278, 101, 261, "Input"],
Cell[141210, 4472, 1108, 32, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142355, 4509, 104, 2, 46, "Input"],
Cell[142462, 4513, 237, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142736, 4522, 3698, 112, 261, "Input"],
Cell[146437, 4636, 1302, 34, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147776, 4675, 108, 2, 46, "Input"],
Cell[147887, 4679, 335, 6, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148259, 4690, 2821, 87, 222, "Input"],
Cell[151083, 4779, 975, 26, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152095, 4810, 106, 2, 46, "Input"],
Cell[152204, 4814, 278, 6, 94, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152531, 4826, 143, 1, 46, "Subsection"],
Cell[152677, 4829, 5376, 161, 262, "EquationNumbered"],
Cell[158056, 4992, 251, 5, 31, "Text"],
Cell[158310, 4999, 2135, 61, 78, "EquationNumbered"],
Cell[160448, 5062, 204, 4, 31, "Text"],
Cell[160655, 5068, 3047, 86, 112, "EquationNumbered"],
Cell[163705, 5156, 89, 1, 31, "Text"],
Cell[163797, 5159, 3283, 91, 114, "EquationNumbered"],
Cell[167083, 5252, 221, 7, 31, "Text"],
Cell[167307, 5261, 2503, 69, 114, "EquationNumbered"],
Cell[169813, 5332, 295, 8, 31, "Text"],
Cell[170111, 5342, 539, 17, 65, "EquationNumbered"],
Cell[170653, 5361, 510, 12, 40, "EquationNumbered"],
Cell[171166, 5375, 99, 1, 31, "Text"],
Cell[171268, 5378, 369, 11, 63, "EquationNumbered"],
Cell[171640, 5391, 875, 27, 55, "Text"],
Cell[172518, 5420, 384, 11, 63, "EquationNumbered"],
Cell[172905, 5433, 101, 1, 31, "Text"],
Cell[173009, 5436, 435, 15, 40, "EquationNumbered"],
Cell[173447, 5453, 114, 1, 31, "Text"],
Cell[173564, 5456, 906, 33, 40, "EquationNumbered"],
Cell[174473, 5491, 90, 1, 31, "Text"],
Cell[174566, 5494, 519, 17, 40, "EquationNumbered"],
Cell[175088, 5513, 498, 18, 34, "Text"],
Cell[175589, 5533, 619, 21, 40, "EquationNumbered"],
Cell[176211, 5556, 542, 18, 40, "EquationNumbered"],
Cell[176756, 5576, 148, 2, 31, "Text"],
Cell[176907, 5580, 370, 10, 44, "EquationNumbered"],
Cell[177280, 5592, 1050, 33, 55, "Text"],
Cell[178333, 5627, 1596, 49, 65, "EquationNumbered"],
Cell[179932, 5678, 1040, 27, 40, "Text"],
Cell[180975, 5707, 789, 26, 44, "EquationNumbered"],
Cell[181767, 5735, 617, 24, 34, "Text"],
Cell[182387, 5761, 741, 25, 44, "EquationNumbered"],
Cell[183131, 5788, 144, 2, 31, "Text"],
Cell[183278, 5792, 408, 13, 44, "EquationNumbered"],
Cell[183689, 5807, 369, 13, 40, "EquationNumbered"],
Cell[184061, 5822, 340, 12, 31, "Text"],
Cell[184404, 5836, 935, 33, 31, "Text"],
Cell[185342, 5871, 135, 1, 31, "Text"],
Cell[185480, 5874, 1982, 55, 66, "EquationNumbered"],
Cell[187465, 5931, 504, 17, 40, "EquationNumbered"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

